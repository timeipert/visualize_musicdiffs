(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function Gt(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Tr(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function $e(t){let e,n,r;t.length!==2?(e=Gt,n=(s,c)=>Gt(t(s),c),r=(s,c)=>t(s)-c):(e=t===Gt||t===Tr?t:$r,n=t,r=t);function i(s,c,u=0,l=s.length){if(u<l){if(e(c,c)!==0)return l;do{const d=u+l>>>1;n(s[d],c)<0?u=d+1:l=d}while(u<l)}return u}function o(s,c,u=0,l=s.length){if(u<l){if(e(c,c)!==0)return l;do{const d=u+l>>>1;n(s[d],c)<=0?u=d+1:l=d}while(u<l)}return u}function a(s,c,u=0,l=s.length){const d=i(s,c,u,l-1);return d>u&&r(s[d-1],c)>-r(s[d],c)?d-1:d}return{left:i,center:a,right:o}}function $r(){return 0}function Lr(t){return t===null?NaN:+t}const Ir=$e(Gt),Cr=Ir.right;$e(Lr).center;class Xe extends Map{constructor(e,n=Dr){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[r,i]of e)this.set(r,i)}get(e){return super.get(Ge(this,e))}has(e){return super.has(Ge(this,e))}set(e,n){return super.set(zr(this,e),n)}delete(e){return super.delete(Rr(this,e))}}function Ge({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function zr({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function Rr({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function Dr(t){return t!==null&&typeof t=="object"?t.valueOf():t}const Or=Math.sqrt(50),Br=Math.sqrt(10),Pr=Math.sqrt(2);function Kt(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=Or?10:o>=Br?5:o>=Pr?2:1;let s,c,u;return i<0?(u=Math.pow(10,-i)/a,s=Math.round(t*u),c=Math.round(e*u),s/u<t&&++s,c/u>e&&--c,u=-u):(u=Math.pow(10,i)*a,s=Math.round(t/u),c=Math.round(e/u),s*u<t&&++s,c*u>e&&--c),c<s&&.5<=n&&n<2?Kt(t,e,n*2):[s,c,u]}function Fr(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,o,a]=r?Kt(e,t,n):Kt(t,e,n);if(!(o>=i))return[];const s=o-i+1,c=new Array(s);if(r)if(a<0)for(let u=0;u<s;++u)c[u]=(o-u)/-a;else for(let u=0;u<s;++u)c[u]=(o-u)*a;else if(a<0)for(let u=0;u<s;++u)c[u]=(i+u)/-a;else for(let u=0;u<s;++u)c[u]=(i+u)*a;return c}function we(t,e,n){return e=+e,t=+t,n=+n,Kt(t,e,n)[2]}function qr(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?we(e,t,n):we(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function Zt(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function Hr(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,o=new Array(i);++r<i;)o[r]=t+r*n;return o}function Sn(t,e){let n=0;for(let r of t)(r=+r)&&(n+=r);return n}var Vr={value:()=>{}};function Rt(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Ut(n)}function Ut(t){this._=t}function Xr(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Ut.prototype=Rt.prototype={constructor:Ut,on:function(t,e){var n=this._,r=Xr(t+"",n),i,o=-1,a=r.length;if(arguments.length<2){for(;++o<a;)if((i=(t=r[o]).type)&&(i=Gr(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++o<a;)if(i=(t=r[o]).type)n[i]=Ue(n[i],t.name,e);else if(e==null)for(i in n)n[i]=Ue(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Ut(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],r=0,i=o.length;r<i;++r)o[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};function Gr(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function Ue(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=Vr,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var xe="http://www.w3.org/1999/xhtml";const Ye={svg:"http://www.w3.org/2000/svg",xhtml:xe,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ue(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),Ye.hasOwnProperty(e)?{space:Ye[e],local:t}:t}function Ur(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===xe&&e.documentElement.namespaceURI===xe?e.createElement(t):e.createElementNS(n,t)}}function Yr(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function En(t){var e=ue(t);return(e.local?Yr:Ur)(e)}function Jr(){}function Le(t){return t==null?Jr:function(){return this.querySelector(t)}}function Wr(t){typeof t!="function"&&(t=Le(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],a=o.length,s=r[i]=new Array(a),c,u,l=0;l<a;++l)(c=o[l])&&(u=t.call(c,c.__data__,l,o))&&("__data__"in c&&(u.__data__=c.__data__),s[l]=u);return new V(r,this._parents)}function Tn(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function Kr(){return[]}function $n(t){return t==null?Kr:function(){return this.querySelectorAll(t)}}function Zr(t){return function(){return Tn(t.apply(this,arguments))}}function Qr(t){typeof t=="function"?t=Zr(t):t=$n(t);for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var a=e[o],s=a.length,c,u=0;u<s;++u)(c=a[u])&&(r.push(t.call(c,c.__data__,u,a)),i.push(c));return new V(r,i)}function Ln(t){return function(){return this.matches(t)}}function In(t){return function(e){return e.matches(t)}}var jr=Array.prototype.find;function ti(t){return function(){return jr.call(this.children,t)}}function ei(){return this.firstElementChild}function ni(t){return this.select(t==null?ei:ti(typeof t=="function"?t:In(t)))}var ri=Array.prototype.filter;function ii(){return Array.from(this.children)}function oi(t){return function(){return ri.call(this.children,t)}}function ai(t){return this.selectAll(t==null?ii:oi(typeof t=="function"?t:In(t)))}function si(t){typeof t!="function"&&(t=Ln(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],a=o.length,s=r[i]=[],c,u=0;u<a;++u)(c=o[u])&&t.call(c,c.__data__,u,o)&&s.push(c);return new V(r,this._parents)}function Cn(t){return new Array(t.length)}function ui(){return new V(this._enter||this._groups.map(Cn),this._parents)}function Qt(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Qt.prototype={constructor:Qt,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function ci(t){return function(){return t}}function li(t,e,n,r,i,o){for(var a=0,s,c=e.length,u=o.length;a<u;++a)(s=e[a])?(s.__data__=o[a],r[a]=s):n[a]=new Qt(t,o[a]);for(;a<c;++a)(s=e[a])&&(i[a]=s)}function fi(t,e,n,r,i,o,a){var s,c,u=new Map,l=e.length,d=o.length,m=new Array(l),p;for(s=0;s<l;++s)(c=e[s])&&(m[s]=p=a.call(c,c.__data__,s,e)+"",u.has(p)?i[s]=c:u.set(p,c));for(s=0;s<d;++s)p=a.call(t,o[s],s,o)+"",(c=u.get(p))?(r[s]=c,c.__data__=o[s],u.delete(p)):n[s]=new Qt(t,o[s]);for(s=0;s<l;++s)(c=e[s])&&u.get(m[s])===c&&(i[s]=c)}function hi(t){return t.__data__}function di(t,e){if(!arguments.length)return Array.from(this,hi);var n=e?fi:li,r=this._parents,i=this._groups;typeof t!="function"&&(t=ci(t));for(var o=i.length,a=new Array(o),s=new Array(o),c=new Array(o),u=0;u<o;++u){var l=r[u],d=i[u],m=d.length,p=gi(t.call(l,l&&l.__data__,u,r)),N=p.length,h=s[u]=new Array(N),y=a[u]=new Array(N),f=c[u]=new Array(m);n(l,d,h,y,f,p,e);for(var v=0,x=0,g,_;v<N;++v)if(g=h[v]){for(v>=x&&(x=v+1);!(_=y[x])&&++x<N;);g._next=_||null}}return a=new V(a,r),a._enter=s,a._exit=c,a}function gi(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function mi(){return new V(this._exit||this._groups.map(Cn),this._parents)}function pi(t,e,n){var r=this.enter(),i=this,o=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?o.remove():n(o),r&&i?r.merge(i).order():i}function yi(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,o=r.length,a=Math.min(i,o),s=new Array(i),c=0;c<a;++c)for(var u=n[c],l=r[c],d=u.length,m=s[c]=new Array(d),p,N=0;N<d;++N)(p=u[N]||l[N])&&(m[N]=p);for(;c<i;++c)s[c]=n[c];return new V(s,this._parents)}function vi(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,o=r[i],a;--i>=0;)(a=r[i])&&(o&&a.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(a,o),o=a);return this}function wi(t){t||(t=xi);function e(d,m){return d&&m?t(d.__data__,m.__data__):!d-!m}for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a=n[o],s=a.length,c=i[o]=new Array(s),u,l=0;l<s;++l)(u=a[l])&&(c[l]=u);c.sort(e)}return new V(i,this._parents).order()}function xi(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function _i(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function bi(){return Array.from(this)}function ki(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null}function Ni(){let t=0;for(const e of this)++t;return t}function Mi(){return!this.node()}function Ai(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],o=0,a=i.length,s;o<a;++o)(s=i[o])&&t.call(s,s.__data__,o,i);return this}function Si(t){return function(){this.removeAttribute(t)}}function Ei(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ti(t,e){return function(){this.setAttribute(t,e)}}function $i(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Li(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Ii(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Ci(t,e){var n=ue(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?Ei:Si:typeof e=="function"?n.local?Ii:Li:n.local?$i:Ti)(n,e))}function zn(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function zi(t){return function(){this.style.removeProperty(t)}}function Ri(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Di(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Oi(t,e,n){return arguments.length>1?this.each((e==null?zi:typeof e=="function"?Di:Ri)(t,e,n??"")):vt(this.node(),t)}function vt(t,e){return t.style.getPropertyValue(e)||zn(t).getComputedStyle(t,null).getPropertyValue(e)}function Bi(t){return function(){delete this[t]}}function Pi(t,e){return function(){this[t]=e}}function Fi(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function qi(t,e){return arguments.length>1?this.each((e==null?Bi:typeof e=="function"?Fi:Pi)(t,e)):this.node()[t]}function Rn(t){return t.trim().split(/^|\s+/)}function Ie(t){return t.classList||new Dn(t)}function Dn(t){this._node=t,this._names=Rn(t.getAttribute("class")||"")}Dn.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function On(t,e){for(var n=Ie(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function Bn(t,e){for(var n=Ie(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function Hi(t){return function(){On(this,t)}}function Vi(t){return function(){Bn(this,t)}}function Xi(t,e){return function(){(e.apply(this,arguments)?On:Bn)(this,t)}}function Gi(t,e){var n=Rn(t+"");if(arguments.length<2){for(var r=Ie(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?Xi:e?Hi:Vi)(n,e))}function Ui(){this.textContent=""}function Yi(t){return function(){this.textContent=t}}function Ji(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function Wi(t){return arguments.length?this.each(t==null?Ui:(typeof t=="function"?Ji:Yi)(t)):this.node().textContent}function Ki(){this.innerHTML=""}function Zi(t){return function(){this.innerHTML=t}}function Qi(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function ji(t){return arguments.length?this.each(t==null?Ki:(typeof t=="function"?Qi:Zi)(t)):this.node().innerHTML}function to(){this.nextSibling&&this.parentNode.appendChild(this)}function eo(){return this.each(to)}function no(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ro(){return this.each(no)}function io(t){var e=typeof t=="function"?t:En(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function oo(){return null}function ao(t,e){var n=typeof t=="function"?t:En(t),r=e==null?oo:typeof e=="function"?e:Le(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function so(){var t=this.parentNode;t&&t.removeChild(this)}function uo(){return this.each(so)}function co(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function lo(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function fo(t){return this.select(t?lo:co)}function ho(t){return arguments.length?this.property("__data__",t):this.node().__data__}function go(t){return function(e){t.call(this,e,this.__data__)}}function mo(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function po(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,o;n<i;++n)o=e[n],(!t.type||o.type===t.type)&&o.name===t.name?this.removeEventListener(o.type,o.listener,o.options):e[++r]=o;++r?e.length=r:delete this.__on}}}function yo(t,e,n){return function(){var r=this.__on,i,o=go(e);if(r){for(var a=0,s=r.length;a<s;++a)if((i=r[a]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),i.value=e;return}}this.addEventListener(t.type,o,n),i={type:t.type,name:t.name,value:e,listener:o,options:n},r?r.push(i):this.__on=[i]}}function vo(t,e,n){var r=mo(t+""),i,o=r.length,a;if(arguments.length<2){var s=this.node().__on;if(s){for(var c=0,u=s.length,l;c<u;++c)for(i=0,l=s[c];i<o;++i)if((a=r[i]).type===l.type&&a.name===l.name)return l.value}return}for(s=e?yo:po,i=0;i<o;++i)this.each(s(r[i],e,n));return this}function Pn(t,e,n){var r=zn(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function wo(t,e){return function(){return Pn(this,t,e)}}function xo(t,e){return function(){return Pn(this,t,e.apply(this,arguments))}}function _o(t,e){return this.each((typeof e=="function"?xo:wo)(t,e))}function*bo(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length,a;i<o;++i)(a=r[i])&&(yield a)}var Ce=[null];function V(t,e){this._groups=t,this._parents=e}function Dt(){return new V([[document.documentElement]],Ce)}function ko(){return this}V.prototype=Dt.prototype={constructor:V,select:Wr,selectAll:Qr,selectChild:ni,selectChildren:ai,filter:si,data:di,enter:ui,exit:mi,join:pi,merge:yi,selection:ko,order:vi,sort:wi,call:_i,nodes:bi,node:ki,size:Ni,empty:Mi,each:Ai,attr:Ci,style:Oi,property:qi,classed:Gi,text:Wi,html:ji,raise:eo,lower:ro,append:io,insert:ao,remove:uo,clone:fo,datum:ho,on:vo,dispatch:_o,[Symbol.iterator]:bo};function q(t){return typeof t=="string"?new V([[document.querySelector(t)]],[document.documentElement]):new V([[t]],Ce)}function No(t){let e;for(;e=t.sourceEvent;)t=e;return t}function W(t,e){if(t=No(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}function Mo(t){return typeof t=="string"?new V([document.querySelectorAll(t)],[document.documentElement]):new V([Tn(t)],Ce)}const Ao={passive:!1},Tt={capture:!0,passive:!1};function de(t){t.stopImmediatePropagation()}function pt(t){t.preventDefault(),t.stopImmediatePropagation()}function Fn(t){var e=t.document.documentElement,n=q(t).on("dragstart.drag",pt,Tt);"onselectstart"in e?n.on("selectstart.drag",pt,Tt):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function qn(t,e){var n=t.document.documentElement,r=q(t).on("dragstart.drag",null);e&&(r.on("click.drag",pt,Tt),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Bt=t=>()=>t;function _e(t,{sourceEvent:e,subject:n,target:r,identifier:i,active:o,x:a,y:s,dx:c,dy:u,dispatch:l}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:l}})}_e.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function So(t){return!t.ctrlKey&&!t.button}function Eo(){return this.parentNode}function To(t,e){return e??{x:t.x,y:t.y}}function $o(){return navigator.maxTouchPoints||"ontouchstart"in this}function Hn(){var t=So,e=Eo,n=To,r=$o,i={},o=Rt("start","drag","end"),a=0,s,c,u,l,d=0;function m(g){g.on("mousedown.drag",p).filter(r).on("touchstart.drag",y).on("touchmove.drag",f,Ao).on("touchend.drag touchcancel.drag",v).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(g,_){if(!(l||!t.call(this,g,_))){var k=x(this,e.call(this,g,_),g,_,"mouse");k&&(q(g.view).on("mousemove.drag",N,Tt).on("mouseup.drag",h,Tt),Fn(g.view),de(g),u=!1,s=g.clientX,c=g.clientY,k("start",g))}}function N(g){if(pt(g),!u){var _=g.clientX-s,k=g.clientY-c;u=_*_+k*k>d}i.mouse("drag",g)}function h(g){q(g.view).on("mousemove.drag mouseup.drag",null),qn(g.view,u),pt(g),i.mouse("end",g)}function y(g,_){if(t.call(this,g,_)){var k=g.changedTouches,b=e.call(this,g,_),M=k.length,S,L;for(S=0;S<M;++S)(L=x(this,b,g,_,k[S].identifier,k[S]))&&(de(g),L("start",g,k[S]))}}function f(g){var _=g.changedTouches,k=_.length,b,M;for(b=0;b<k;++b)(M=i[_[b].identifier])&&(pt(g),M("drag",g,_[b]))}function v(g){var _=g.changedTouches,k=_.length,b,M;for(l&&clearTimeout(l),l=setTimeout(function(){l=null},500),b=0;b<k;++b)(M=i[_[b].identifier])&&(de(g),M("end",g,_[b]))}function x(g,_,k,b,M,S){var L=o.copy(),E=W(S||k,_),R,I,w;if((w=n.call(g,new _e("beforestart",{sourceEvent:k,target:m,identifier:M,active:a,x:E[0],y:E[1],dx:0,dy:0,dispatch:L}),b))!=null)return R=w.x-E[0]||0,I=w.y-E[1]||0,function T(A,$,z){var C=E,D;switch(A){case"start":i[M]=T,D=a++;break;case"end":delete i[M],--a;case"drag":E=W(z||$,_),D=a;break}L.call(A,g,new _e(A,{sourceEvent:$,subject:w,target:m,identifier:M,active:D,x:E[0]+R,y:E[1]+I,dx:E[0]-C[0],dy:E[1]-C[1],dispatch:L}),b)}}return m.filter=function(g){return arguments.length?(t=typeof g=="function"?g:Bt(!!g),m):t},m.container=function(g){return arguments.length?(e=typeof g=="function"?g:Bt(g),m):e},m.subject=function(g){return arguments.length?(n=typeof g=="function"?g:Bt(g),m):n},m.touchable=function(g){return arguments.length?(r=typeof g=="function"?g:Bt(!!g),m):r},m.on=function(){var g=o.on.apply(o,arguments);return g===o?m:g},m.clickDistance=function(g){return arguments.length?(d=(g=+g)*g,m):Math.sqrt(d)},m}function ze(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Vn(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Ot(){}var $t=.7,jt=1/$t,yt="\\s*([+-]?\\d+)\\s*",Lt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",et="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Lo=/^#([0-9a-f]{3,8})$/,Io=new RegExp(`^rgb\\(${yt},${yt},${yt}\\)$`),Co=new RegExp(`^rgb\\(${et},${et},${et}\\)$`),zo=new RegExp(`^rgba\\(${yt},${yt},${yt},${Lt}\\)$`),Ro=new RegExp(`^rgba\\(${et},${et},${et},${Lt}\\)$`),Do=new RegExp(`^hsl\\(${Lt},${et},${et}\\)$`),Oo=new RegExp(`^hsla\\(${Lt},${et},${et},${Lt}\\)$`),Je={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ze(Ot,dt,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:We,formatHex:We,formatHex8:Bo,formatHsl:Po,formatRgb:Ke,toString:Ke});function We(){return this.rgb().formatHex()}function Bo(){return this.rgb().formatHex8()}function Po(){return Xn(this).formatHsl()}function Ke(){return this.rgb().formatRgb()}function dt(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Lo.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Ze(e):n===3?new G(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Pt(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Pt(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Io.exec(t))?new G(e[1],e[2],e[3],1):(e=Co.exec(t))?new G(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=zo.exec(t))?Pt(e[1],e[2],e[3],e[4]):(e=Ro.exec(t))?Pt(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Do.exec(t))?tn(e[1],e[2]/100,e[3]/100,1):(e=Oo.exec(t))?tn(e[1],e[2]/100,e[3]/100,e[4]):Je.hasOwnProperty(t)?Ze(Je[t]):t==="transparent"?new G(NaN,NaN,NaN,0):null}function Ze(t){return new G(t>>16&255,t>>8&255,t&255,1)}function Pt(t,e,n,r){return r<=0&&(t=e=n=NaN),new G(t,e,n,r)}function Fo(t){return t instanceof Ot||(t=dt(t)),t?(t=t.rgb(),new G(t.r,t.g,t.b,t.opacity)):new G}function te(t,e,n,r){return arguments.length===1?Fo(t):new G(t,e,n,r??1)}function G(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}ze(G,te,Vn(Ot,{brighter(t){return t=t==null?jt:Math.pow(jt,t),new G(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?$t:Math.pow($t,t),new G(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new G(ht(this.r),ht(this.g),ht(this.b),ee(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Qe,formatHex:Qe,formatHex8:qo,formatRgb:je,toString:je}));function Qe(){return`#${lt(this.r)}${lt(this.g)}${lt(this.b)}`}function qo(){return`#${lt(this.r)}${lt(this.g)}${lt(this.b)}${lt((isNaN(this.opacity)?1:this.opacity)*255)}`}function je(){const t=ee(this.opacity);return`${t===1?"rgb(":"rgba("}${ht(this.r)}, ${ht(this.g)}, ${ht(this.b)}${t===1?")":`, ${t})`}`}function ee(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ht(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function lt(t){return t=ht(t),(t<16?"0":"")+t.toString(16)}function tn(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Z(t,e,n,r)}function Xn(t){if(t instanceof Z)return new Z(t.h,t.s,t.l,t.opacity);if(t instanceof Ot||(t=dt(t)),!t)return new Z;if(t instanceof Z)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,c=(o+i)/2;return s?(e===o?a=(n-r)/s+(n<r)*6:n===o?a=(r-e)/s+2:a=(e-n)/s+4,s/=c<.5?o+i:2-o-i,a*=60):s=c>0&&c<1?0:a,new Z(a,s,c,t.opacity)}function Ho(t,e,n,r){return arguments.length===1?Xn(t):new Z(t,e,n,r??1)}function Z(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}ze(Z,Ho,Vn(Ot,{brighter(t){return t=t==null?jt:Math.pow(jt,t),new Z(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?$t:Math.pow($t,t),new Z(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new G(ge(t>=240?t-240:t+120,i,r),ge(t,i,r),ge(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Z(en(this.h),Ft(this.s),Ft(this.l),ee(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=ee(this.opacity);return`${t===1?"hsl(":"hsla("}${en(this.h)}, ${Ft(this.s)*100}%, ${Ft(this.l)*100}%${t===1?")":`, ${t})`}`}}));function en(t){return t=(t||0)%360,t<0?t+360:t}function Ft(t){return Math.max(0,Math.min(1,t||0))}function ge(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function Vo(t,e,n,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*r+a*i)/6}function Xo(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],a=r>0?t[r-1]:2*i-o,s=r<e-1?t[r+2]:2*o-i;return Vo((n-r/e)*e,a,i,o,s)}}const Re=t=>()=>t;function Go(t,e){return function(n){return t+n*e}}function Uo(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function Yo(t){return(t=+t)==1?Gn:function(e,n){return n-e?Uo(e,n,t):Re(isNaN(e)?n:e)}}function Gn(t,e){var n=e-t;return n?Go(t,n):Re(isNaN(t)?e:t)}const ne=(function t(e){var n=Yo(e);function r(i,o){var a=n((i=te(i)).r,(o=te(o)).r),s=n(i.g,o.g),c=n(i.b,o.b),u=Gn(i.opacity,o.opacity);return function(l){return i.r=a(l),i.g=s(l),i.b=c(l),i.opacity=u(l),i+""}}return r.gamma=t,r})(1);function Jo(t){return function(e){var n=e.length,r=new Array(n),i=new Array(n),o=new Array(n),a,s;for(a=0;a<n;++a)s=te(e[a]),r[a]=s.r||0,i[a]=s.g||0,o[a]=s.b||0;return r=t(r),i=t(i),o=t(o),s.opacity=1,function(c){return s.r=r(c),s.g=i(c),s.b=o(c),s+""}}}var Wo=Jo(Xo);function Ko(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=t[i]*(1-o)+e[i]*o;return r}}function Zo(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Qo(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),o=new Array(n),a;for(a=0;a<r;++a)i[a]=ce(t[a],e[a]);for(;a<n;++a)o[a]=e[a];return function(s){for(a=0;a<r;++a)o[a]=i[a](s);return o}}function jo(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function K(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function ta(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=ce(t[i],e[i]):r[i]=e[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var be=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,me=new RegExp(be.source,"g");function ea(t){return function(){return t}}function na(t){return function(e){return t(e)+""}}function Un(t,e){var n=be.lastIndex=me.lastIndex=0,r,i,o,a=-1,s=[],c=[];for(t=t+"",e=e+"";(r=be.exec(t))&&(i=me.exec(e));)(o=i.index)>n&&(o=e.slice(n,o),s[a]?s[a]+=o:s[++a]=o),(r=r[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,c.push({i:a,x:K(r,i)})),n=me.lastIndex;return n<e.length&&(o=e.slice(n),s[a]?s[a]+=o:s[++a]=o),s.length<2?c[0]?na(c[0].x):ea(e):(e=c.length,function(u){for(var l=0,d;l<e;++l)s[(d=c[l]).i]=d.x(u);return s.join("")})}function ce(t,e){var n=typeof e,r;return e==null||n==="boolean"?Re(e):(n==="number"?K:n==="string"?(r=dt(e))?(e=r,ne):Un:e instanceof dt?ne:e instanceof Date?jo:Zo(e)?Ko:Array.isArray(e)?Qo:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?ta:K)(t,e)}function Yn(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var nn=180/Math.PI,ke={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Jn(t,e,n,r,i,o){var a,s,c;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(c=t*n+e*r)&&(n-=t*c,r-=e*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),t*r<e*n&&(t=-t,e=-e,c=-c,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*nn,skewX:Math.atan(c)*nn,scaleX:a,scaleY:s}}var qt;function ra(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?ke:Jn(e.a,e.b,e.c,e.d,e.e,e.f)}function ia(t){return t==null||(qt||(qt=document.createElementNS("http://www.w3.org/2000/svg","g")),qt.setAttribute("transform",t),!(t=qt.transform.baseVal.consolidate()))?ke:(t=t.matrix,Jn(t.a,t.b,t.c,t.d,t.e,t.f))}function Wn(t,e,n,r){function i(u){return u.length?u.pop()+" ":""}function o(u,l,d,m,p,N){if(u!==d||l!==m){var h=p.push("translate(",null,e,null,n);N.push({i:h-4,x:K(u,d)},{i:h-2,x:K(l,m)})}else(d||m)&&p.push("translate("+d+e+m+n)}function a(u,l,d,m){u!==l?(u-l>180?l+=360:l-u>180&&(u+=360),m.push({i:d.push(i(d)+"rotate(",null,r)-2,x:K(u,l)})):l&&d.push(i(d)+"rotate("+l+r)}function s(u,l,d,m){u!==l?m.push({i:d.push(i(d)+"skewX(",null,r)-2,x:K(u,l)}):l&&d.push(i(d)+"skewX("+l+r)}function c(u,l,d,m,p,N){if(u!==d||l!==m){var h=p.push(i(p)+"scale(",null,",",null,")");N.push({i:h-4,x:K(u,d)},{i:h-2,x:K(l,m)})}else(d!==1||m!==1)&&p.push(i(p)+"scale("+d+","+m+")")}return function(u,l){var d=[],m=[];return u=t(u),l=t(l),o(u.translateX,u.translateY,l.translateX,l.translateY,d,m),a(u.rotate,l.rotate,d,m),s(u.skewX,l.skewX,d,m),c(u.scaleX,u.scaleY,l.scaleX,l.scaleY,d,m),u=l=null,function(p){for(var N=-1,h=m.length,y;++N<h;)d[(y=m[N]).i]=y.x(p);return d.join("")}}}var oa=Wn(ra,"px, ","px)","deg)"),aa=Wn(ia,", ",")",")"),sa=1e-12;function rn(t){return((t=Math.exp(t))+1/t)/2}function ua(t){return((t=Math.exp(t))-1/t)/2}function ca(t){return((t=Math.exp(2*t))-1)/(t+1)}const la=(function t(e,n,r){function i(o,a){var s=o[0],c=o[1],u=o[2],l=a[0],d=a[1],m=a[2],p=l-s,N=d-c,h=p*p+N*N,y,f;if(h<sa)f=Math.log(m/u)/e,y=function(b){return[s+b*p,c+b*N,u*Math.exp(e*b*f)]};else{var v=Math.sqrt(h),x=(m*m-u*u+r*h)/(2*u*n*v),g=(m*m-u*u-r*h)/(2*m*n*v),_=Math.log(Math.sqrt(x*x+1)-x),k=Math.log(Math.sqrt(g*g+1)-g);f=(k-_)/e,y=function(b){var M=b*f,S=rn(_),L=u/(n*v)*(S*ca(e*M+_)-ua(_));return[s+L*p,c+L*N,u*S/rn(e*M+_)]}}return y.duration=f*1e3*e/Math.SQRT2,y}return i.rho=function(o){var a=Math.max(.001,+o),s=a*a,c=s*s;return t(a,s,c)},i})(Math.SQRT2,2,4);var wt=0,Mt=0,_t=0,Kn=1e3,re,At,ie=0,gt=0,le=0,It=typeof performance=="object"&&performance.now?performance:Date,Zn=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function De(){return gt||(Zn(fa),gt=It.now()+le)}function fa(){gt=0}function oe(){this._call=this._time=this._next=null}oe.prototype=Oe.prototype={constructor:oe,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?De():+n)+(e==null?0:+e),!this._next&&At!==this&&(At?At._next=this:re=this,At=this),this._call=t,this._time=n,Ne()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ne())}};function Oe(t,e,n){var r=new oe;return r.restart(t,e,n),r}function ha(){De(),++wt;for(var t=re,e;t;)(e=gt-t._time)>=0&&t._call.call(void 0,e),t=t._next;--wt}function on(){gt=(ie=It.now())+le,wt=Mt=0;try{ha()}finally{wt=0,ga(),gt=0}}function da(){var t=It.now(),e=t-ie;e>Kn&&(le-=e,ie=t)}function ga(){for(var t,e=re,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:re=n);At=t,Ne(r)}function Ne(t){if(!wt){Mt&&(Mt=clearTimeout(Mt));var e=t-gt;e>24?(t<1/0&&(Mt=setTimeout(on,t-It.now()-le)),_t&&(_t=clearInterval(_t))):(_t||(ie=It.now(),_t=setInterval(da,Kn)),wt=1,Zn(on))}}function an(t,e,n){var r=new oe;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var ma=Rt("start","end","cancel","interrupt"),pa=[],Qn=0,sn=1,Me=2,Yt=3,un=4,Ae=5,Jt=6;function fe(t,e,n,r,i,o){var a=t.__transition;if(!a)t.__transition={};else if(n in a)return;ya(t,n,{name:e,index:r,group:i,on:ma,tween:pa,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:Qn})}function Be(t,e){var n=Q(t,e);if(n.state>Qn)throw new Error("too late; already scheduled");return n}function nt(t,e){var n=Q(t,e);if(n.state>Yt)throw new Error("too late; already running");return n}function Q(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function ya(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=Oe(o,0,n.time);function o(u){n.state=sn,n.timer.restart(a,n.delay,n.time),n.delay<=u&&a(u-n.delay)}function a(u){var l,d,m,p;if(n.state!==sn)return c();for(l in r)if(p=r[l],p.name===n.name){if(p.state===Yt)return an(a);p.state===un?(p.state=Jt,p.timer.stop(),p.on.call("interrupt",t,t.__data__,p.index,p.group),delete r[l]):+l<e&&(p.state=Jt,p.timer.stop(),p.on.call("cancel",t,t.__data__,p.index,p.group),delete r[l])}if(an(function(){n.state===Yt&&(n.state=un,n.timer.restart(s,n.delay,n.time),s(u))}),n.state=Me,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Me){for(n.state=Yt,i=new Array(m=n.tween.length),l=0,d=-1;l<m;++l)(p=n.tween[l].value.call(t,t.__data__,n.index,n.group))&&(i[++d]=p);i.length=d+1}}function s(u){for(var l=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(c),n.state=Ae,1),d=-1,m=i.length;++d<m;)i[d].call(t,l);n.state===Ae&&(n.on.call("end",t,t.__data__,n.index,n.group),c())}function c(){n.state=Jt,n.timer.stop(),delete r[e];for(var u in r)return;delete t.__transition}}function Wt(t,e){var n=t.__transition,r,i,o=!0,a;if(n){e=e==null?null:e+"";for(a in n){if((r=n[a]).name!==e){o=!1;continue}i=r.state>Me&&r.state<Ae,r.state=Jt,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[a]}o&&delete t.__transition}}function va(t){return this.each(function(){Wt(this,t)})}function wa(t,e){var n,r;return function(){var i=nt(this,t),o=i.tween;if(o!==n){r=n=o;for(var a=0,s=r.length;a<s;++a)if(r[a].name===e){r=r.slice(),r.splice(a,1);break}}i.tween=r}}function xa(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var o=nt(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:e,value:n},c=0,u=i.length;c<u;++c)if(i[c].name===e){i[c]=s;break}c===u&&i.push(s)}o.tween=i}}function _a(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=Q(this.node(),n).tween,i=0,o=r.length,a;i<o;++i)if((a=r[i]).name===t)return a.value;return null}return this.each((e==null?wa:xa)(n,t,e))}function Pe(t,e,n){var r=t._id;return t.each(function(){var i=nt(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return Q(i,r).value[e]}}function jn(t,e){var n;return(typeof e=="number"?K:e instanceof dt?ne:(n=dt(e))?(e=n,ne):Un)(t,e)}function ba(t){return function(){this.removeAttribute(t)}}function ka(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Na(t,e,n){var r,i=n+"",o;return function(){var a=this.getAttribute(t);return a===i?null:a===r?o:o=e(r=a,n)}}function Ma(t,e,n){var r,i=n+"",o;return function(){var a=this.getAttributeNS(t.space,t.local);return a===i?null:a===r?o:o=e(r=a,n)}}function Aa(t,e,n){var r,i,o;return function(){var a,s=n(this),c;return s==null?void this.removeAttribute(t):(a=this.getAttribute(t),c=s+"",a===c?null:a===r&&c===i?o:(i=c,o=e(r=a,s)))}}function Sa(t,e,n){var r,i,o;return function(){var a,s=n(this),c;return s==null?void this.removeAttributeNS(t.space,t.local):(a=this.getAttributeNS(t.space,t.local),c=s+"",a===c?null:a===r&&c===i?o:(i=c,o=e(r=a,s)))}}function Ea(t,e){var n=ue(t),r=n==="transform"?aa:jn;return this.attrTween(t,typeof e=="function"?(n.local?Sa:Aa)(n,r,Pe(this,"attr."+t,e)):e==null?(n.local?ka:ba)(n):(n.local?Ma:Na)(n,r,e))}function Ta(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function $a(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function La(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&$a(t,o)),n}return i._value=e,i}function Ia(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&Ta(t,o)),n}return i._value=e,i}function Ca(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=ue(t);return this.tween(n,(r.local?La:Ia)(r,e))}function za(t,e){return function(){Be(this,t).delay=+e.apply(this,arguments)}}function Ra(t,e){return e=+e,function(){Be(this,t).delay=e}}function Da(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?za:Ra)(e,t)):Q(this.node(),e).delay}function Oa(t,e){return function(){nt(this,t).duration=+e.apply(this,arguments)}}function Ba(t,e){return e=+e,function(){nt(this,t).duration=e}}function Pa(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Oa:Ba)(e,t)):Q(this.node(),e).duration}function Fa(t,e){if(typeof e!="function")throw new Error;return function(){nt(this,t).ease=e}}function qa(t){var e=this._id;return arguments.length?this.each(Fa(e,t)):Q(this.node(),e).ease}function Ha(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;nt(this,t).ease=n}}function Va(t){if(typeof t!="function")throw new Error;return this.each(Ha(this._id,t))}function Xa(t){typeof t!="function"&&(t=Ln(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],a=o.length,s=r[i]=[],c,u=0;u<a;++u)(c=o[u])&&t.call(c,c.__data__,u,o)&&s.push(c);return new st(r,this._parents,this._name,this._id)}function Ga(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var c=e[s],u=n[s],l=c.length,d=a[s]=new Array(l),m,p=0;p<l;++p)(m=c[p]||u[p])&&(d[p]=m);for(;s<r;++s)a[s]=e[s];return new st(a,this._parents,this._name,this._id)}function Ua(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Ya(t,e,n){var r,i,o=Ua(e)?Be:nt;return function(){var a=o(this,t),s=a.on;s!==r&&(i=(r=s).copy()).on(e,n),a.on=i}}function Ja(t,e){var n=this._id;return arguments.length<2?Q(this.node(),n).on.on(t):this.each(Ya(n,t,e))}function Wa(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function Ka(){return this.on("end.remove",Wa(this._id))}function Za(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Le(t));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s=r[a],c=s.length,u=o[a]=new Array(c),l,d,m=0;m<c;++m)(l=s[m])&&(d=t.call(l,l.__data__,m,s))&&("__data__"in l&&(d.__data__=l.__data__),u[m]=d,fe(u[m],e,n,m,u,Q(l,n)));return new st(o,this._parents,e,n)}function Qa(t){var e=this._name,n=this._id;typeof t!="function"&&(t=$n(t));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var c=r[s],u=c.length,l,d=0;d<u;++d)if(l=c[d]){for(var m=t.call(l,l.__data__,d,c),p,N=Q(l,n),h=0,y=m.length;h<y;++h)(p=m[h])&&fe(p,e,n,h,m,N);o.push(m),a.push(l)}return new st(o,a,e,n)}var ja=Dt.prototype.constructor;function ts(){return new ja(this._groups,this._parents)}function es(t,e){var n,r,i;return function(){var o=vt(this,t),a=(this.style.removeProperty(t),vt(this,t));return o===a?null:o===n&&a===r?i:i=e(n=o,r=a)}}function tr(t){return function(){this.style.removeProperty(t)}}function ns(t,e,n){var r,i=n+"",o;return function(){var a=vt(this,t);return a===i?null:a===r?o:o=e(r=a,n)}}function rs(t,e,n){var r,i,o;return function(){var a=vt(this,t),s=n(this),c=s+"";return s==null&&(c=s=(this.style.removeProperty(t),vt(this,t))),a===c?null:a===r&&c===i?o:(i=c,o=e(r=a,s))}}function is(t,e){var n,r,i,o="style."+e,a="end."+o,s;return function(){var c=nt(this,t),u=c.on,l=c.value[o]==null?s||(s=tr(e)):void 0;(u!==n||i!==l)&&(r=(n=u).copy()).on(a,i=l),c.on=r}}function os(t,e,n){var r=(t+="")=="transform"?oa:jn;return e==null?this.styleTween(t,es(t,r)).on("end.style."+t,tr(t)):typeof e=="function"?this.styleTween(t,rs(t,r,Pe(this,"style."+t,e))).each(is(this._id,t)):this.styleTween(t,ns(t,r,e),n).on("end.style."+t,null)}function as(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function ss(t,e,n){var r,i;function o(){var a=e.apply(this,arguments);return a!==i&&(r=(i=a)&&as(t,a,n)),r}return o._value=e,o}function us(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,ss(t,e,n??""))}function cs(t){return function(){this.textContent=t}}function ls(t){return function(){var e=t(this);this.textContent=e??""}}function fs(t){return this.tween("text",typeof t=="function"?ls(Pe(this,"text",t)):cs(t==null?"":t+""))}function hs(t){return function(e){this.textContent=t.call(this,e)}}function ds(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&hs(i)),e}return r._value=t,r}function gs(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,ds(t))}function ms(){for(var t=this._name,e=this._id,n=er(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,c,u=0;u<s;++u)if(c=a[u]){var l=Q(c,e);fe(c,t,n,u,a,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new st(r,this._parents,t,n)}function ps(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(o,a){var s={value:a},c={value:function(){--i===0&&o()}};n.each(function(){var u=nt(this,r),l=u.on;l!==t&&(e=(t=l).copy(),e._.cancel.push(s),e._.interrupt.push(s),e._.end.push(c)),u.on=e}),i===0&&o()})}var ys=0;function st(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function er(){return++ys}var ot=Dt.prototype;st.prototype={constructor:st,select:Za,selectAll:Qa,selectChild:ot.selectChild,selectChildren:ot.selectChildren,filter:Xa,merge:Ga,selection:ts,transition:ms,call:ot.call,nodes:ot.nodes,node:ot.node,size:ot.size,empty:ot.empty,each:ot.each,on:Ja,attr:Ea,attrTween:Ca,style:os,styleTween:us,text:fs,textTween:gs,remove:Ka,tween:_a,delay:Da,duration:Pa,ease:qa,easeVarying:Va,end:ps,[Symbol.iterator]:ot[Symbol.iterator]};function vs(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var ws={time:null,delay:0,duration:250,ease:vs};function xs(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function _s(t){var e,n;t instanceof st?(e=t._id,t=t._name):(e=er(),(n=ws).time=De(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,c,u=0;u<s;++u)(c=a[u])&&fe(c,t,e,u,a,n||xs(c,e));return new st(r,this._parents,t,e)}Dt.prototype.interrupt=va;Dt.prototype.transition=_s;function nr(t,e){var n,r=1;t==null&&(t=0),e==null&&(e=0);function i(){var o,a=n.length,s,c=0,u=0;for(o=0;o<a;++o)s=n[o],c+=s.x,u+=s.y;for(c=(c/a-t)*r,u=(u/a-e)*r,o=0;o<a;++o)s=n[o],s.x-=c,s.y-=u}return i.initialize=function(o){n=o},i.x=function(o){return arguments.length?(t=+o,i):t},i.y=function(o){return arguments.length?(e=+o,i):e},i.strength=function(o){return arguments.length?(r=+o,i):r},i}function bs(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return rr(this.cover(e,n),e,n,t)}function rr(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,o=t._root,a={data:r},s=t._x0,c=t._y0,u=t._x1,l=t._y1,d,m,p,N,h,y,f,v;if(!o)return t._root=a,t;for(;o.length;)if((h=e>=(d=(s+u)/2))?s=d:u=d,(y=n>=(m=(c+l)/2))?c=m:l=m,i=o,!(o=o[f=y<<1|h]))return i[f]=a,t;if(p=+t._x.call(null,o.data),N=+t._y.call(null,o.data),e===p&&n===N)return a.next=o,i?i[f]=a:t._root=a,t;do i=i?i[f]=new Array(4):t._root=new Array(4),(h=e>=(d=(s+u)/2))?s=d:u=d,(y=n>=(m=(c+l)/2))?c=m:l=m;while((f=y<<1|h)===(v=(N>=m)<<1|p>=d));return i[v]=o,i[f]=a,t}function ks(t){var e,n,r=t.length,i,o,a=new Array(r),s=new Array(r),c=1/0,u=1/0,l=-1/0,d=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,e=t[n]))||isNaN(o=+this._y.call(null,e))||(a[n]=i,s[n]=o,i<c&&(c=i),i>l&&(l=i),o<u&&(u=o),o>d&&(d=o));if(c>l||u>d)return this;for(this.cover(c,u).cover(l,d),n=0;n<r;++n)rr(this,a[n],s[n],t[n]);return this}function Ns(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,o=(r=Math.floor(e))+1;else{for(var a=i-n||1,s=this._root,c,u;n>t||t>=i||r>e||e>=o;)switch(u=(e<r)<<1|t<n,c=new Array(4),c[u]=s,s=c,a*=2,u){case 0:i=n+a,o=r+a;break;case 1:n=i-a,o=r+a;break;case 2:i=n+a,r=o-a;break;case 3:n=i-a,r=o-a;break}this._root&&this._root.length&&(this._root=s)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this}function Ms(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function As(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function H(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i}function Ss(t,e,n){var r,i=this._x0,o=this._y0,a,s,c,u,l=this._x1,d=this._y1,m=[],p=this._root,N,h;for(p&&m.push(new H(p,i,o,l,d)),n==null?n=1/0:(i=t-n,o=e-n,l=t+n,d=e+n,n*=n);N=m.pop();)if(!(!(p=N.node)||(a=N.x0)>l||(s=N.y0)>d||(c=N.x1)<i||(u=N.y1)<o))if(p.length){var y=(a+c)/2,f=(s+u)/2;m.push(new H(p[3],y,f,c,u),new H(p[2],a,f,y,u),new H(p[1],y,s,c,f),new H(p[0],a,s,y,f)),(h=(e>=f)<<1|t>=y)&&(N=m[m.length-1],m[m.length-1]=m[m.length-1-h],m[m.length-1-h]=N)}else{var v=t-+this._x.call(null,p.data),x=e-+this._y.call(null,p.data),g=v*v+x*x;if(g<n){var _=Math.sqrt(n=g);i=t-_,o=e-_,l=t+_,d=e+_,r=p.data}}return r}function Es(t){if(isNaN(l=+this._x.call(null,t))||isNaN(d=+this._y.call(null,t)))return this;var e,n=this._root,r,i,o,a=this._x0,s=this._y0,c=this._x1,u=this._y1,l,d,m,p,N,h,y,f;if(!n)return this;if(n.length)for(;;){if((N=l>=(m=(a+c)/2))?a=m:c=m,(h=d>=(p=(s+u)/2))?s=p:u=p,e=n,!(n=n[y=h<<1|N]))return this;if(!n.length)break;(e[y+1&3]||e[y+2&3]||e[y+3&3])&&(r=e,f=y)}for(;n.data!==t;)if(i=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,i?(o?i.next=o:delete i.next,this):e?(o?e[y]=o:delete e[y],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(r?r[f]=n:this._root=n),this):(this._root=o,this)}function Ts(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function $s(){return this._root}function Ls(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function Is(t){var e=[],n,r=this._root,i,o,a,s,c;for(r&&e.push(new H(r,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!t(r=n.node,o=n.x0,a=n.y0,s=n.x1,c=n.y1)&&r.length){var u=(o+s)/2,l=(a+c)/2;(i=r[3])&&e.push(new H(i,u,l,s,c)),(i=r[2])&&e.push(new H(i,o,l,u,c)),(i=r[1])&&e.push(new H(i,u,a,s,l)),(i=r[0])&&e.push(new H(i,o,a,u,l))}return this}function Cs(t){var e=[],n=[],r;for(this._root&&e.push(new H(this._root,this._x0,this._y0,this._x1,this._y1));r=e.pop();){var i=r.node;if(i.length){var o,a=r.x0,s=r.y0,c=r.x1,u=r.y1,l=(a+c)/2,d=(s+u)/2;(o=i[0])&&e.push(new H(o,a,s,l,d)),(o=i[1])&&e.push(new H(o,l,s,c,d)),(o=i[2])&&e.push(new H(o,a,d,l,u)),(o=i[3])&&e.push(new H(o,l,d,c,u))}n.push(r)}for(;r=n.pop();)t(r.node,r.x0,r.y0,r.x1,r.y1);return this}function zs(t){return t[0]}function Rs(t){return arguments.length?(this._x=t,this):this._x}function Ds(t){return t[1]}function Os(t){return arguments.length?(this._y=t,this):this._y}function ir(t,e,n){var r=new Fe(e??zs,n??Ds,NaN,NaN,NaN,NaN);return t==null?r:r.addAll(t)}function Fe(t,e,n,r,i,o){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function cn(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var X=ir.prototype=Fe.prototype;X.copy=function(){var t=new Fe(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,r;if(!e)return t;if(!e.length)return t._root=cn(e),t;for(n=[{source:e,target:t._root=new Array(4)}];e=n.pop();)for(var i=0;i<4;++i)(r=e.source[i])&&(r.length?n.push({source:r,target:e.target[i]=new Array(4)}):e.target[i]=cn(r));return t};X.add=bs;X.addAll=ks;X.cover=Ns;X.data=Ms;X.extent=As;X.find=Ss;X.remove=Es;X.removeAll=Ts;X.root=$s;X.size=Ls;X.visit=Is;X.visitAfter=Cs;X.x=Rs;X.y=Os;function Et(t){return function(){return t}}function mt(t){return(t()-.5)*1e-6}function Bs(t){return t.index}function ln(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function or(t){var e=Bs,n=d,r,i=Et(30),o,a,s,c,u,l=1;t==null&&(t=[]);function d(y){return 1/Math.min(s[y.source.index],s[y.target.index])}function m(y){for(var f=0,v=t.length;f<l;++f)for(var x=0,g,_,k,b,M,S,L;x<v;++x)g=t[x],_=g.source,k=g.target,b=k.x+k.vx-_.x-_.vx||mt(u),M=k.y+k.vy-_.y-_.vy||mt(u),S=Math.sqrt(b*b+M*M),S=(S-o[x])/S*y*r[x],b*=S,M*=S,k.vx-=b*(L=c[x]),k.vy-=M*L,_.vx+=b*(L=1-L),_.vy+=M*L}function p(){if(a){var y,f=a.length,v=t.length,x=new Map(a.map((_,k)=>[e(_,k,a),_])),g;for(y=0,s=new Array(f);y<v;++y)g=t[y],g.index=y,typeof g.source!="object"&&(g.source=ln(x,g.source)),typeof g.target!="object"&&(g.target=ln(x,g.target)),s[g.source.index]=(s[g.source.index]||0)+1,s[g.target.index]=(s[g.target.index]||0)+1;for(y=0,c=new Array(v);y<v;++y)g=t[y],c[y]=s[g.source.index]/(s[g.source.index]+s[g.target.index]);r=new Array(v),N(),o=new Array(v),h()}}function N(){if(a)for(var y=0,f=t.length;y<f;++y)r[y]=+n(t[y],y,t)}function h(){if(a)for(var y=0,f=t.length;y<f;++y)o[y]=+i(t[y],y,t)}return m.initialize=function(y,f){a=y,u=f,p()},m.links=function(y){return arguments.length?(t=y,p(),m):t},m.id=function(y){return arguments.length?(e=y,m):e},m.iterations=function(y){return arguments.length?(l=+y,m):l},m.strength=function(y){return arguments.length?(n=typeof y=="function"?y:Et(+y),N(),m):n},m.distance=function(y){return arguments.length?(i=typeof y=="function"?y:Et(+y),h(),m):i},m}const Ps=1664525,Fs=1013904223,fn=4294967296;function qs(){let t=1;return()=>(t=(Ps*t+Fs)%fn)/fn}function Hs(t){return t.x}function Vs(t){return t.y}var Xs=10,Gs=Math.PI*(3-Math.sqrt(5));function ar(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,a=.6,s=new Map,c=Oe(d),u=Rt("tick","end"),l=qs();t==null&&(t=[]);function d(){m(),u.call("tick",e),n<r&&(c.stop(),u.call("end",e))}function m(h){var y,f=t.length,v;h===void 0&&(h=1);for(var x=0;x<h;++x)for(n+=(o-n)*i,s.forEach(function(g){g(n)}),y=0;y<f;++y)v=t[y],v.fx==null?v.x+=v.vx*=a:(v.x=v.fx,v.vx=0),v.fy==null?v.y+=v.vy*=a:(v.y=v.fy,v.vy=0);return e}function p(){for(var h=0,y=t.length,f;h<y;++h){if(f=t[h],f.index=h,f.fx!=null&&(f.x=f.fx),f.fy!=null&&(f.y=f.fy),isNaN(f.x)||isNaN(f.y)){var v=Xs*Math.sqrt(.5+h),x=h*Gs;f.x=v*Math.cos(x),f.y=v*Math.sin(x)}(isNaN(f.vx)||isNaN(f.vy))&&(f.vx=f.vy=0)}}function N(h){return h.initialize&&h.initialize(t,l),h}return p(),e={tick:m,restart:function(){return c.restart(d),e},stop:function(){return c.stop(),e},nodes:function(h){return arguments.length?(t=h,p(),s.forEach(N),e):t},alpha:function(h){return arguments.length?(n=+h,e):n},alphaMin:function(h){return arguments.length?(r=+h,e):r},alphaDecay:function(h){return arguments.length?(i=+h,e):+i},alphaTarget:function(h){return arguments.length?(o=+h,e):o},velocityDecay:function(h){return arguments.length?(a=1-h,e):1-a},randomSource:function(h){return arguments.length?(l=h,s.forEach(N),e):l},force:function(h,y){return arguments.length>1?(y==null?s.delete(h):s.set(h,N(y)),e):s.get(h)},find:function(h,y,f){var v=0,x=t.length,g,_,k,b,M;for(f==null?f=1/0:f*=f,v=0;v<x;++v)b=t[v],g=h-b.x,_=y-b.y,k=g*g+_*_,k<f&&(M=b,f=k);return M},on:function(h,y){return arguments.length>1?(u.on(h,y),e):u.on(h)}}}function sr(){var t,e,n,r,i=Et(-30),o,a=1,s=1/0,c=.81;function u(p){var N,h=t.length,y=ir(t,Hs,Vs).visitAfter(d);for(r=p,N=0;N<h;++N)e=t[N],y.visit(m)}function l(){if(t){var p,N=t.length,h;for(o=new Array(N),p=0;p<N;++p)h=t[p],o[h.index]=+i(h,p,t)}}function d(p){var N=0,h,y,f=0,v,x,g;if(p.length){for(v=x=g=0;g<4;++g)(h=p[g])&&(y=Math.abs(h.value))&&(N+=h.value,f+=y,v+=y*h.x,x+=y*h.y);p.x=v/f,p.y=x/f}else{h=p,h.x=h.data.x,h.y=h.data.y;do N+=o[h.data.index];while(h=h.next)}p.value=N}function m(p,N,h,y){if(!p.value)return!0;var f=p.x-e.x,v=p.y-e.y,x=y-N,g=f*f+v*v;if(x*x/c<g)return g<s&&(f===0&&(f=mt(n),g+=f*f),v===0&&(v=mt(n),g+=v*v),g<a&&(g=Math.sqrt(a*g)),e.vx+=f*p.value*r/g,e.vy+=v*p.value*r/g),!0;if(p.length||g>=s)return;(p.data!==e||p.next)&&(f===0&&(f=mt(n),g+=f*f),v===0&&(v=mt(n),g+=v*v),g<a&&(g=Math.sqrt(a*g)));do p.data!==e&&(x=o[p.data.index]*r/g,e.vx+=f*x,e.vy+=v*x);while(p=p.next)}return u.initialize=function(p,N){t=p,n=N,l()},u.strength=function(p){return arguments.length?(i=typeof p=="function"?p:Et(+p),l(),u):i},u.distanceMin=function(p){return arguments.length?(a=p*p,u):Math.sqrt(a)},u.distanceMax=function(p){return arguments.length?(s=p*p,u):Math.sqrt(s)},u.theta=function(p){return arguments.length?(c=p*p,u):Math.sqrt(c)},u}function Us(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function ae(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function xt(t){return t=ae(Math.abs(t)),t?t[1]:NaN}function Ys(t,e){return function(n,r){for(var i=n.length,o=[],a=0,s=t[0],c=0;i>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),o.push(n.substring(i-=s,i+s)),!((c+=s+1)>r));)s=t[a=(a+1)%t.length];return o.reverse().join(e)}}function Js(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var Ws=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function se(t){if(!(e=Ws.exec(t)))throw new Error("invalid format: "+t);var e;return new qe({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}se.prototype=qe.prototype;function qe(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}qe.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Ks(t){t:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var ur;function Zs(t,e){var n=ae(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(ur=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+ae(t,Math.max(0,e+o-1))[0]}function hn(t,e){var n=ae(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const dn={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Us,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>hn(t*100,e),r:hn,s:Zs,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function gn(t){return t}var mn=Array.prototype.map,pn=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Qs(t){var e=t.grouping===void 0||t.thousands===void 0?gn:Ys(mn.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?gn:Js(mn.call(t.numerals,String)),a=t.percent===void 0?"%":t.percent+"",s=t.minus===void 0?"−":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function u(d){d=se(d);var m=d.fill,p=d.align,N=d.sign,h=d.symbol,y=d.zero,f=d.width,v=d.comma,x=d.precision,g=d.trim,_=d.type;_==="n"?(v=!0,_="g"):dn[_]||(x===void 0&&(x=12),g=!0,_="g"),(y||m==="0"&&p==="=")&&(y=!0,m="0",p="=");var k=h==="$"?n:h==="#"&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",b=h==="$"?r:/[%p]/.test(_)?a:"",M=dn[_],S=/[defgprs%]/.test(_);x=x===void 0?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,x)):Math.max(0,Math.min(20,x));function L(E){var R=k,I=b,w,T,A;if(_==="c")I=M(E)+I,E="";else{E=+E;var $=E<0||1/E<0;if(E=isNaN(E)?c:M(Math.abs(E),x),g&&(E=Ks(E)),$&&+E==0&&N!=="+"&&($=!1),R=($?N==="("?N:s:N==="-"||N==="("?"":N)+R,I=(_==="s"?pn[8+ur/3]:"")+I+($&&N==="("?")":""),S){for(w=-1,T=E.length;++w<T;)if(A=E.charCodeAt(w),48>A||A>57){I=(A===46?i+E.slice(w+1):E.slice(w))+I,E=E.slice(0,w);break}}}v&&!y&&(E=e(E,1/0));var z=R.length+E.length+I.length,C=z<f?new Array(f-z+1).join(m):"";switch(v&&y&&(E=e(C+E,C.length?f-I.length:1/0),C=""),p){case"<":E=R+E+I+C;break;case"=":E=R+C+E+I;break;case"^":E=C.slice(0,z=C.length>>1)+R+E+I+C.slice(z);break;default:E=C+R+E+I;break}return o(E)}return L.toString=function(){return d+""},L}function l(d,m){var p=u((d=se(d),d.type="f",d)),N=Math.max(-8,Math.min(8,Math.floor(xt(m)/3)))*3,h=Math.pow(10,-N),y=pn[8+N/3];return function(f){return p(h*f)+y}}return{format:u,formatPrefix:l}}var Ht,cr,lr;js({thousands:",",grouping:[3],currency:["$",""]});function js(t){return Ht=Qs(t),cr=Ht.format,lr=Ht.formatPrefix,Ht}function tu(t){return Math.max(0,-xt(Math.abs(t)))}function eu(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(xt(e)/3)))*3-xt(Math.abs(t)))}function nu(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,xt(e)-xt(t))+1}function fr(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function ru(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const yn=Symbol("implicit");function hr(){var t=new Xe,e=[],n=[],r=yn;function i(o){let a=t.get(o);if(a===void 0){if(r!==yn)return r;t.set(o,a=e.push(o)-1)}return n[a%n.length]}return i.domain=function(o){if(!arguments.length)return e.slice();e=[],t=new Xe;for(const a of o)t.has(a)||t.set(a,e.push(a)-1);return i},i.range=function(o){return arguments.length?(n=Array.from(o),i):n.slice()},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return hr(e,n).unknown(r)},fr.apply(i,arguments),i}function iu(t){return function(){return t}}function ou(t){return+t}var vn=[0,1];function ut(t){return t}function Se(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:iu(isNaN(e)?NaN:.5)}function au(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function su(t,e,n){var r=t[0],i=t[1],o=e[0],a=e[1];return i<r?(r=Se(i,r),o=n(a,o)):(r=Se(r,i),o=n(o,a)),function(s){return o(r(s))}}function uu(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)i[a]=Se(t[a],t[a+1]),o[a]=n(e[a],e[a+1]);return function(s){var c=Cr(t,s,1,r)-1;return o[c](i[c](s))}}function cu(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function lu(){var t=vn,e=vn,n=ce,r,i,o,a=ut,s,c,u;function l(){var m=Math.min(t.length,e.length);return a!==ut&&(a=au(t[0],t[m-1])),s=m>2?uu:su,c=u=null,d}function d(m){return m==null||isNaN(m=+m)?o:(c||(c=s(t.map(r),e,n)))(r(a(m)))}return d.invert=function(m){return a(i((u||(u=s(e,t.map(r),K)))(m)))},d.domain=function(m){return arguments.length?(t=Array.from(m,ou),l()):t.slice()},d.range=function(m){return arguments.length?(e=Array.from(m),l()):e.slice()},d.rangeRound=function(m){return e=Array.from(m),n=Yn,l()},d.clamp=function(m){return arguments.length?(a=m?!0:ut,l()):a!==ut},d.interpolate=function(m){return arguments.length?(n=m,l()):n},d.unknown=function(m){return arguments.length?(o=m,d):o},function(m,p){return r=m,i=p,l()}}function fu(){return lu()(ut,ut)}function hu(t,e,n,r){var i=qr(t,e,n),o;switch(r=se(r??",f"),r.type){case"s":{var a=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(o=eu(i,a))&&(r.precision=o),lr(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=nu(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=tu(i))&&(r.precision=o-(r.type==="%")*2);break}}return cr(r)}function dr(t){var e=t.domain;return t.ticks=function(n){var r=e();return Fr(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return hu(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,o=r.length-1,a=r[i],s=r[o],c,u,l=10;for(s<a&&(u=a,a=s,s=u,u=i,i=o,o=u);l-- >0;){if(u=we(a,s,n),u===c)return r[i]=a,r[o]=s,e(r);if(u>0)a=Math.floor(a/u)*u,s=Math.ceil(s/u)*u;else if(u<0)a=Math.ceil(a*u)/u,s=Math.floor(s*u)/u;else break;c=u}return t},t}function He(){var t=fu();return t.copy=function(){return cu(t,He())},fr.apply(t,arguments),dr(t)}function du(){var t=0,e=1,n,r,i,o,a=ut,s=!1,c;function u(d){return d==null||isNaN(d=+d)?c:a(i===0?.5:(d=(o(d)-n)*i,s?Math.max(0,Math.min(1,d)):d))}u.domain=function(d){return arguments.length?([t,e]=d,n=o(t=+t),r=o(e=+e),i=n===r?0:1/(r-n),u):[t,e]},u.clamp=function(d){return arguments.length?(s=!!d,u):s},u.interpolator=function(d){return arguments.length?(a=d,u):a};function l(d){return function(m){var p,N;return arguments.length?([p,N]=m,a=d(p,N),u):[a(0),a(1)]}}return u.range=l(ce),u.rangeRound=l(Yn),u.unknown=function(d){return arguments.length?(c=d,u):c},function(d){return o=d,n=d(t),r=d(e),i=n===r?0:1/(r-n),u}}function gu(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function gr(){var t=dr(du()(ut));return t.copy=function(){return gu(t,gr())},ru.apply(t,arguments)}function mr(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(r*6,++r*6);return n}const mu=mr("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),pu=t=>Wo(t[t.length-1]);var yu=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(mr);const vu=pu(yu),Vt=t=>()=>t;function wu(t,{sourceEvent:e,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function at(t,e,n){this.k=t,this.x=e,this.y=n}at.prototype={constructor:at,scale:function(t){return t===1?this:new at(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new at(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Ve=new at(1,0,0);at.prototype;function pe(t){t.stopImmediatePropagation()}function bt(t){t.preventDefault(),t.stopImmediatePropagation()}function xu(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function _u(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function wn(){return this.__zoom||Ve}function bu(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function ku(){return navigator.maxTouchPoints||"ontouchstart"in this}function Nu(t,e,n){var r=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],o=t.invertY(e[0][1])-n[0][1],a=t.invertY(e[1][1])-n[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a))}function pr(){var t=xu,e=_u,n=Nu,r=bu,i=ku,o=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],s=250,c=la,u=Rt("start","zoom","end"),l,d,m,p=500,N=150,h=0,y=10;function f(w){w.property("__zoom",wn).on("wheel.zoom",M,{passive:!1}).on("mousedown.zoom",S).on("dblclick.zoom",L).filter(i).on("touchstart.zoom",E).on("touchmove.zoom",R).on("touchend.zoom touchcancel.zoom",I).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}f.transform=function(w,T,A,$){var z=w.selection?w.selection():w;z.property("__zoom",wn),w!==z?_(w,T,A,$):z.interrupt().each(function(){k(this,arguments).event($).start().zoom(null,typeof T=="function"?T.apply(this,arguments):T).end()})},f.scaleBy=function(w,T,A,$){f.scaleTo(w,function(){var z=this.__zoom.k,C=typeof T=="function"?T.apply(this,arguments):T;return z*C},A,$)},f.scaleTo=function(w,T,A,$){f.transform(w,function(){var z=e.apply(this,arguments),C=this.__zoom,D=A==null?g(z):typeof A=="function"?A.apply(this,arguments):A,B=C.invert(D),P=typeof T=="function"?T.apply(this,arguments):T;return n(x(v(C,P),D,B),z,a)},A,$)},f.translateBy=function(w,T,A,$){f.transform(w,function(){return n(this.__zoom.translate(typeof T=="function"?T.apply(this,arguments):T,typeof A=="function"?A.apply(this,arguments):A),e.apply(this,arguments),a)},null,$)},f.translateTo=function(w,T,A,$,z){f.transform(w,function(){var C=e.apply(this,arguments),D=this.__zoom,B=$==null?g(C):typeof $=="function"?$.apply(this,arguments):$;return n(Ve.translate(B[0],B[1]).scale(D.k).translate(typeof T=="function"?-T.apply(this,arguments):-T,typeof A=="function"?-A.apply(this,arguments):-A),C,a)},$,z)};function v(w,T){return T=Math.max(o[0],Math.min(o[1],T)),T===w.k?w:new at(T,w.x,w.y)}function x(w,T,A){var $=T[0]-A[0]*w.k,z=T[1]-A[1]*w.k;return $===w.x&&z===w.y?w:new at(w.k,$,z)}function g(w){return[(+w[0][0]+ +w[1][0])/2,(+w[0][1]+ +w[1][1])/2]}function _(w,T,A,$){w.on("start.zoom",function(){k(this,arguments).event($).start()}).on("interrupt.zoom end.zoom",function(){k(this,arguments).event($).end()}).tween("zoom",function(){var z=this,C=arguments,D=k(z,C).event($),B=e.apply(z,C),P=A==null?g(B):typeof A=="function"?A.apply(z,C):A,j=Math.max(B[1][0]-B[0][0],B[1][1]-B[0][1]),F=z.__zoom,Y=typeof T=="function"?T.apply(z,C):T,rt=c(F.invert(P).concat(j/F.k),Y.invert(P).concat(j/Y.k));return function(J){if(J===1)J=Y;else{var it=rt(J),he=j/it[2];J=new at(he,P[0]-it[0]*he,P[1]-it[1]*he)}D.zoom(null,J)}})}function k(w,T,A){return!A&&w.__zooming||new b(w,T)}function b(w,T){this.that=w,this.args=T,this.active=0,this.sourceEvent=null,this.extent=e.apply(w,T),this.taps=0}b.prototype={event:function(w){return w&&(this.sourceEvent=w),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(w,T){return this.mouse&&w!=="mouse"&&(this.mouse[1]=T.invert(this.mouse[0])),this.touch0&&w!=="touch"&&(this.touch0[1]=T.invert(this.touch0[0])),this.touch1&&w!=="touch"&&(this.touch1[1]=T.invert(this.touch1[0])),this.that.__zoom=T,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(w){var T=q(this.that).datum();u.call(w,this.that,new wu(w,{sourceEvent:this.sourceEvent,target:f,transform:this.that.__zoom,dispatch:u}),T)}};function M(w,...T){if(!t.apply(this,arguments))return;var A=k(this,T).event(w),$=this.__zoom,z=Math.max(o[0],Math.min(o[1],$.k*Math.pow(2,r.apply(this,arguments)))),C=W(w);if(A.wheel)(A.mouse[0][0]!==C[0]||A.mouse[0][1]!==C[1])&&(A.mouse[1]=$.invert(A.mouse[0]=C)),clearTimeout(A.wheel);else{if($.k===z)return;A.mouse=[C,$.invert(C)],Wt(this),A.start()}bt(w),A.wheel=setTimeout(D,N),A.zoom("mouse",n(x(v($,z),A.mouse[0],A.mouse[1]),A.extent,a));function D(){A.wheel=null,A.end()}}function S(w,...T){if(m||!t.apply(this,arguments))return;var A=w.currentTarget,$=k(this,T,!0).event(w),z=q(w.view).on("mousemove.zoom",P,!0).on("mouseup.zoom",j,!0),C=W(w,A),D=w.clientX,B=w.clientY;Fn(w.view),pe(w),$.mouse=[C,this.__zoom.invert(C)],Wt(this),$.start();function P(F){if(bt(F),!$.moved){var Y=F.clientX-D,rt=F.clientY-B;$.moved=Y*Y+rt*rt>h}$.event(F).zoom("mouse",n(x($.that.__zoom,$.mouse[0]=W(F,A),$.mouse[1]),$.extent,a))}function j(F){z.on("mousemove.zoom mouseup.zoom",null),qn(F.view,$.moved),bt(F),$.event(F).end()}}function L(w,...T){if(t.apply(this,arguments)){var A=this.__zoom,$=W(w.changedTouches?w.changedTouches[0]:w,this),z=A.invert($),C=A.k*(w.shiftKey?.5:2),D=n(x(v(A,C),$,z),e.apply(this,T),a);bt(w),s>0?q(this).transition().duration(s).call(_,D,$,w):q(this).call(f.transform,D,$,w)}}function E(w,...T){if(t.apply(this,arguments)){var A=w.touches,$=A.length,z=k(this,T,w.changedTouches.length===$).event(w),C,D,B,P;for(pe(w),D=0;D<$;++D)B=A[D],P=W(B,this),P=[P,this.__zoom.invert(P),B.identifier],z.touch0?!z.touch1&&z.touch0[2]!==P[2]&&(z.touch1=P,z.taps=0):(z.touch0=P,C=!0,z.taps=1+!!l);l&&(l=clearTimeout(l)),C&&(z.taps<2&&(d=P[0],l=setTimeout(function(){l=null},p)),Wt(this),z.start())}}function R(w,...T){if(this.__zooming){var A=k(this,T).event(w),$=w.changedTouches,z=$.length,C,D,B,P;for(bt(w),C=0;C<z;++C)D=$[C],B=W(D,this),A.touch0&&A.touch0[2]===D.identifier?A.touch0[0]=B:A.touch1&&A.touch1[2]===D.identifier&&(A.touch1[0]=B);if(D=A.that.__zoom,A.touch1){var j=A.touch0[0],F=A.touch0[1],Y=A.touch1[0],rt=A.touch1[1],J=(J=Y[0]-j[0])*J+(J=Y[1]-j[1])*J,it=(it=rt[0]-F[0])*it+(it=rt[1]-F[1])*it;D=v(D,Math.sqrt(J/it)),B=[(j[0]+Y[0])/2,(j[1]+Y[1])/2],P=[(F[0]+rt[0])/2,(F[1]+rt[1])/2]}else if(A.touch0)B=A.touch0[0],P=A.touch0[1];else return;A.zoom("touch",n(x(D,B,P),A.extent,a))}}function I(w,...T){if(this.__zooming){var A=k(this,T).event(w),$=w.changedTouches,z=$.length,C,D;for(pe(w),m&&clearTimeout(m),m=setTimeout(function(){m=null},p),C=0;C<z;++C)D=$[C],A.touch0&&A.touch0[2]===D.identifier?delete A.touch0:A.touch1&&A.touch1[2]===D.identifier&&delete A.touch1;if(A.touch1&&!A.touch0&&(A.touch0=A.touch1,delete A.touch1),A.touch0)A.touch0[1]=this.__zoom.invert(A.touch0[0]);else if(A.end(),A.taps===2&&(D=W(D,this),Math.hypot(d[0]-D[0],d[1]-D[1])<y)){var B=q(this).on("dblclick.zoom");B&&B.apply(this,arguments)}}}return f.wheelDelta=function(w){return arguments.length?(r=typeof w=="function"?w:Vt(+w),f):r},f.filter=function(w){return arguments.length?(t=typeof w=="function"?w:Vt(!!w),f):t},f.touchable=function(w){return arguments.length?(i=typeof w=="function"?w:Vt(!!w),f):i},f.extent=function(w){return arguments.length?(e=typeof w=="function"?w:Vt([[+w[0][0],+w[0][1]],[+w[1][0],+w[1][1]]]),f):e},f.scaleExtent=function(w){return arguments.length?(o[0]=+w[0],o[1]=+w[1],f):[o[0],o[1]]},f.translateExtent=function(w){return arguments.length?(a[0][0]=+w[0][0],a[1][0]=+w[1][0],a[0][1]=+w[0][1],a[1][1]=+w[1][1],f):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},f.constrain=function(w){return arguments.length?(n=w,f):n},f.duration=function(w){return arguments.length?(s=+w,f):s},f.interpolate=function(w){return arguments.length?(c=w,f):c},f.on=function(){var w=u.on.apply(u,arguments);return w===u?f:w},f.clickDistance=function(w){return arguments.length?(h=(w=+w)*w,f):Math.sqrt(h)},f.tapDistance=function(w){return arguments.length?(y=+w,f):y},f}let Ee,Ct;function Mu(t,e,n,r,i){Ee=document.getElementById("beatLabel"),Ct=document.getElementById("loader");const o=document.getElementById("exportNetworkBtn"),a=document.getElementById("exportTreeBtn");document.getElementById("exportAxisBtn");const{loadBtn:s,exampleBtn:c,totalTreeBtn:u,totalNetworkBtn:l,resetViewBtn:d}=t;s&&(s.onclick=e),c&&(c.onclick=n),u&&(u.onclick=()=>r("total-tree")),l&&(l.onclick=()=>r("total-network")),d&&(d.onclick=()=>r("reset")),o&&(o.onclick=()=>i("network")),a&&(a.onclick=()=>i("tree"))}function yr(){Ct&&(Ct.style.display="flex")}function vr(){Ct&&(Ct.style.display="none")}function Te(t){Ee&&(Ee.textContent=t)}function Au(t){const e=q("#axis-legend");if(e.empty())return;e.html(""),e.append("strong").text("Differences per Beat:");const n=e.append("svg").attr("height",20).attr("width","100%");n.append("defs").append("linearGradient").attr("id","gradient-axis").selectAll("stop").data(t.ticks().map((o,a,s)=>({offset:`${100*a/s.length}%`,color:t(o)}))).enter().append("stop").attr("offset",o=>o.offset).attr("stop-color",o=>o.color),n.append("rect").attr("width","100%").attr("height",15).style("fill","url(#gradient-axis)"),e.append("div").attr("class","legend-labels").html("<span>less</span><span>more</span>")}const Su=["1803_BdA_ED_Op33_1.mei_1808_Zulehner_Op33_1.mei.txt","1803_BdA_ED_Op33_1.mei_1825_Andre_Op33_1.mei.txt","1803_BdA_ED_Op33_1.mei_1826_Schott_Op33_1.mei.txt","1803_BdA_ED_Op33_1.mei_1845_Haslinger_Op33_1.mei.txt","1803_BdA_ED_Op33_1.mei_1864_Breitkopf_Haertel_Op33_1.mei.txt","1808_Zulehner_Op33_1.mei_1825_Andre_Op33_1.mei.txt","1808_Zulehner_Op33_1.mei_1826_Schott_Op33_1.mei.txt","1808_Zulehner_Op33_1.mei_1845_Haslinger_Op33_1.mei.txt","1808_Zulehner_Op33_1.mei_1864_Breitkopf_Haertel_Op33_1.mei.txt","1825_Andre_Op33_1.mei_1826_Schott_Op33_1.mei.txt","1825_Andre_Op33_1.mei_1845_Haslinger_Op33_1.mei.txt","1825_Andre_Op33_1.mei_1864_Breitkopf_Haertel_Op33_1.mei.txt","1826_Schott_Op33_1.mei_1845_Haslinger_Op33_1.mei.txt","1826_Schott_Op33_1.mei_1864_Breitkopf_Haertel_Op33_1.mei.txt","1845_Haslinger_Op33_1.mei_1864_Breitkopf_Haertel_Op33_1.mei.txt"];async function Eu(t){if(t.useExample){const e=Su.map(n=>{const r=`/visualize_musicdiffs/example/diffs/${n}`;return fetch(r).then(i=>{if(!i.ok)throw new Error(`Datei nicht gefunden: ${r}`);return i.text()})});return Promise.all(e)}else return Promise.all([...t.files].map(e=>e.text()))}function Tu(t){let e={},n={},r=[];t.forEach(p=>{const N=p.split(`
`),h=N[0].replace(/--- (.*\/)?/,"").replace(".mei",""),y=N[1].replace(/\+\+\+ (.*\/)?/,"").replace(".mei","");n[h]||(n[h]={id:h}),n[y]||(n[y]={id:y});const f={source:h,target:y,beatCounts:{},beatDetails:{}};let v=null;N.forEach(x=>{if(x.startsWith("@@")){const g=/measure\s+(\d+),.*beat\s+([\d.]+)/.exec(x);if(g){const _=parseInt(g[1],10),k=parseFloat(g[2]);v=`${_}-${k}`,e[v]||(e[v]={measure:_,beat:k})}}else v&&(x.startsWith("+")||x.startsWith("-"))&&(f.beatCounts[v]=(f.beatCounts[v]||0)+1,f.beatDetails[v]||(f.beatDetails[v]=[]),f.beatDetails[v].push(x))}),r.push(f)});const i=Object.keys(e);if(i.length>0){const p={};i.forEach(N=>{const h=e[N];p[h.measure]||(p[h.measure]=new Set),p[h.measure].add(h.beat)}),Object.entries(p).forEach(([N,h])=>{const y=parseInt(N,10),f=Array.from(h).sort((v,x)=>v-x);if(f.length>1){const v=f.slice(1).map((g,_)=>g-f[_]),x=Math.min(...v.filter(g=>g>1e-9));if(x>0&&isFinite(x)){const g=f[0],_=f[f.length-1],k=Math.round((_-g)/x);for(let b=0;b<=k;b++){const M=+(g+b*x).toFixed(6),S=`${y}-${M}`;e[S]||(e[S]={measure:y,beat:M})}}}})}let o=Object.keys(e).filter(p=>e[p]&&typeof e[p].measure<"u");o.sort((p,N)=>{const[h,y]=p.split("-").map(Number),[f,v]=N.split("-").map(Number);return h!==f?h-f:y-v});const a={};o.forEach((p,N)=>a[p]=N);const s=r.map(p=>{const N={},h={};return Object.entries(p.beatCounts).forEach(([y,f])=>{const v=a[y];typeof v<"u"&&(N[v]=f,h[v]=p.beatDetails[y]||[])}),{id:`${p.source}__${p.target}`,source:p.source,target:p.target,beatCounts:N,beatDetails:h}}),c=Object.values(n),u=c.map(p=>({name:p.id})),l=hr(mu).domain(c.map(p=>p.id)),d=Zt(s,p=>Zt(Object.values(p.beatCounts)))||1,m=gr(vu).domain([0,d]);return{nodes:c,taxa:u,linkData:s,beatInfo:e,allBeatKeys:o,globalMax:d,nodeColor:l,axisColor:m}}async function wr(t){const e=await Eu(t);return Tu(e)}let St;function $u(t,e,n,r,i,o,a,s,c,u){if(t.selectAll("*").remove(),e.selectAll("*").remove(),!i||i.length===0||!r||r.length===0)return t.append("text").attr("x",20).attr("y",20).text("No Data.").attr("fill","#999"),[];const l=25,d=r.length*l;e.style("height",`${d}px`),e.selectAll("div").data(r).join("div").attr("class","axis-panel-label").style("height",`${l}px`).html(S=>`
            <div class="color-swatch-container">
                <div class="color-swatch" style="background-color:${c(S.source)}"></div>
                <div class="color-swatch" style="background-color:${c(S.target)}"></div>
            </div>
            <span>${S.source} vs ${S.target}</span>
        `);const m=t.node().parentElement.getBoundingClientRect().width,p=40,N=100,h=[...new Set(Object.values(o).map(S=>S.measure))].sort((S,L)=>S-L),y=Math.max(m,h.length*N);t.attr("width",y).attr("height",d);const v=(y-p)/h.length,x={};i.forEach(S=>{const L=o[S];L&&typeof L.measure<"u"&&(x[L.measure]||(x[L.measure]=new Set),x[L.measure].add(L.beat))});const g=[];i.forEach((S,L)=>{const E=o[S];if(!E)return;const R=h.indexOf(E.measure),I=Array.from(x[E.measure]||[]).sort((T,A)=>T-A),w=I.indexOf(E.beat);if(R>-1&&w>-1){const T=p+R*v+(w+.5)*(v/I.length);g.push({idx:L,x:T})}});const _=Array(i.length);g.forEach(S=>{_[S.idx]=S.x}),St=t.append("line").attr("stroke","blue").attr("stroke-width",1.5).attr("opacity",.7).style("pointer-events","none").attr("y1",0).attr("y2",d),r.forEach((S,L)=>{const E=t.append("g").attr("transform",`translate(0, ${L*l})`),R=He().domain([0,a]).range([l-2,2]);E.selectAll("rect").data(Hr(i.length)).join("rect").attr("x",I=>_[I]?_[I]-2:-10).attr("y",I=>R(S.beatCounts[I]||0)).attr("width",4).attr("height",I=>l-2-R(S.beatCounts[I]||0)).attr("fill",I=>(S.beatCounts[I]||0)>0?s(S.beatCounts[I]):"transparent").on("mouseover",(I,w)=>{const T=S.beatDetails[w],A=o[i[w]];if(!A||(S.beatCounts[w]||0)===0)return;const $=`<strong>${S.source.id} vs ${S.target.id}</strong><br>Measure: ${A.measure}, Beat: ${A.beat.toFixed(2)}<br>Differences: ${S.beatCounts[w]}<br><hr>${T?T.join("<br>"):"No Details"}`;n.style("opacity",1).html($)}).on("mousemove",I=>n.style("left",I.pageX+15+"px").style("top",I.pageY-28+"px")).on("mouseleave",()=>n.style("opacity",0))});let k=!1;const b=$e(S=>S.x).left;function M(S){if(!g||g.length===0)return 0;const L=b(g,S,1);if(L<=0)return g[0].idx;if(L>=g.length)return g[g.length-1].idx;const E=S-g[L-1].x,R=g[L].x-S;return E<R?g[L-1].idx:g[L].idx}return t.on("click",S=>{k=!k,k&&u(M(W(S)[0]))}).on("mousemove",S=>{k&&u(M(W(S)[0]))}),_}function xr(t,e){St&&e&&typeof e[t]<"u"?St.style("display","block").attr("x1",e[t]).attr("x2",e[t]):St&&St.style("display","none")}let ft,xn,kt;function Lu(t,e,n,r){const{width:i,height:o}=t.node().getBoundingClientRect();t.selectAll("*").remove();const a=t.append("g"),s=l=>{a.attr("transform",l.transform)},c=pr().scaleExtent([.1,4]).on("zoom",s);t.call(c),ft=ar(e).force("link",or(n).id(l=>l.id).distance(100).strength(1)).force("charge",sr().strength(-600)).force("center",nr(i/2,o/2)),xn=a.append("g").attr("stroke","#999").attr("stroke-opacity",.6).selectAll("line").data(n).join("line").attr("stroke-width",1.5),kt=a.append("g").selectAll("g").data(e).join("g"),kt.append("circle").attr("r",8).attr("fill",l=>r(l.id)).attr("stroke","#fff").attr("stroke-width",1.5),kt.append("text").text(l=>l.id).attr("x",12).attr("y",4).attr("font-size","2em").attr("class","node-label");function u(l){function d(N,h){N.active||l.alphaTarget(.3).restart(),h.fx=h.x,h.fy=h.y}function m(N,h){h.fx=N.x,h.fy=N.y}function p(N,h){N.active||l.alphaTarget(0),h.fx=null,h.fy=null}return Hn().on("start",d).on("drag",m).on("end",p)}kt.call(u(ft)),ft.on("tick",()=>{xn.attr("x1",l=>l.source.x).attr("y1",l=>l.source.y).attr("x2",l=>l.target.x).attr("y2",l=>l.target.y),kt.attr("transform",l=>`translate(${l.x}, ${l.y})`)})}function _r(t,e,n,r=!1){if(ft){if(r){const i=e.map(s=>({...s,totalDiffs:Sn(Object.values(s.beatCounts))})),o=Zt(i,s=>s.totalDiffs)||1,a=s=>1-s.totalDiffs/o;ft.force("link").links(i).distance(s=>60+(1-a(s))*240)}else{const i=(o,a)=>1-(o.beatCounts[a]||0)/n;ft.force("link").links(e).distance(o=>60+(1-i(o,t))*240)}ft.alpha(1).restart()}}function Iu(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Nt={},ct={},Xt={},_n;function Cu(){return _n||(_n=1,(function(t){(function(e,n){n(t)})(Xt,function(e){e.__esModule=!0,e.sort=N;function n(h,y){if(!(h instanceof y))throw new TypeError("Cannot call a class as a function")}var r=32,i=7,o=256;function a(h,y){if(h===y)return 0;var f=String(h),v=String(y);return f===v?0:f<v?-1:1}function s(h){for(var y=0;h>=r;)y|=h&1,h>>=1;return h+y}function c(h,y,f,v){var x=y+1;if(x===f)return 1;if(v(h[x++],h[y])<0){for(;x<f&&v(h[x],h[x-1])<0;)x++;u(h,y,x)}else for(;x<f&&v(h[x],h[x-1])>=0;)x++;return x-y}function u(h,y,f){for(f--;y<f;){var v=h[y];h[y++]=h[f],h[f--]=v}}function l(h,y,f,v,x){for(v===y&&v++;v<f;v++){for(var g=h[v],_=y,k=v;_<k;){var b=_+k>>>1;x(g,h[b])<0?k=b:_=b+1}var M=v-_;switch(M){case 3:h[_+3]=h[_+2];case 2:h[_+2]=h[_+1];case 1:h[_+1]=h[_];break;default:for(;M>0;)h[_+M]=h[_+M-1],M--}h[_]=g}}function d(h,y,f,v,x,g){var _=0,k=0,b=1;if(g(h,y[f+x])>0){for(k=v-x;b<k&&g(h,y[f+x+b])>0;)_=b,b=(b<<1)+1,b<=0&&(b=k);b>k&&(b=k),_+=x,b+=x}else{for(k=x+1;b<k&&g(h,y[f+x-b])<=0;)_=b,b=(b<<1)+1,b<=0&&(b=k);b>k&&(b=k);var M=_;_=x-b,b=x-M}for(_++;_<b;){var S=_+(b-_>>>1);g(h,y[f+S])>0?_=S+1:b=S}return b}function m(h,y,f,v,x,g){var _=0,k=0,b=1;if(g(h,y[f+x])<0){for(k=x+1;b<k&&g(h,y[f+x-b])<0;)_=b,b=(b<<1)+1,b<=0&&(b=k);b>k&&(b=k);var M=_;_=x-b,b=x-M}else{for(k=v-x;b<k&&g(h,y[f+x+b])>=0;)_=b,b=(b<<1)+1,b<=0&&(b=k);b>k&&(b=k),_+=x,b+=x}for(_++;_<b;){var S=_+(b-_>>>1);g(h,y[f+S])<0?b=S:_=S+1}return b}var p=(function(){function h(y,f){n(this,h),this.array=null,this.compare=null,this.minGallop=i,this.length=0,this.tmpStorageLength=o,this.stackLength=0,this.runStart=null,this.runLength=null,this.stackSize=0,this.array=y,this.compare=f,this.length=y.length,this.length<2*o&&(this.tmpStorageLength=this.length>>>1),this.tmp=new Array(this.tmpStorageLength),this.stackLength=this.length<120?5:this.length<1542?10:this.length<119151?19:40,this.runStart=new Array(this.stackLength),this.runLength=new Array(this.stackLength)}return h.prototype.pushRun=function(f,v){this.runStart[this.stackSize]=f,this.runLength[this.stackSize]=v,this.stackSize+=1},h.prototype.mergeRuns=function(){for(;this.stackSize>1;){var f=this.stackSize-2;if(f>=1&&this.runLength[f-1]<=this.runLength[f]+this.runLength[f+1]||f>=2&&this.runLength[f-2]<=this.runLength[f]+this.runLength[f-1])this.runLength[f-1]<this.runLength[f+1]&&f--;else if(this.runLength[f]>this.runLength[f+1])break;this.mergeAt(f)}},h.prototype.forceMergeRuns=function(){for(;this.stackSize>1;){var f=this.stackSize-2;f>0&&this.runLength[f-1]<this.runLength[f+1]&&f--,this.mergeAt(f)}},h.prototype.mergeAt=function(f){var v=this.compare,x=this.array,g=this.runStart[f],_=this.runLength[f],k=this.runStart[f+1],b=this.runLength[f+1];this.runLength[f]=_+b,f===this.stackSize-3&&(this.runStart[f+1]=this.runStart[f+2],this.runLength[f+1]=this.runLength[f+2]),this.stackSize--;var M=m(x[k],x,g,_,0,v);g+=M,_-=M,_!==0&&(b=d(x[g+_-1],x,k,b,b-1,v),b!==0&&(_<=b?this.mergeLow(g,_,k,b):this.mergeHigh(g,_,k,b)))},h.prototype.mergeLow=function(f,v,x,g){var _=this.compare,k=this.array,b=this.tmp,M=0;for(M=0;M<v;M++)b[M]=k[f+M];var S=0,L=x,E=f;if(k[E++]=k[L++],--g===0){for(M=0;M<v;M++)k[E+M]=b[S+M];return}if(v===1){for(M=0;M<g;M++)k[E+M]=k[L+M];k[E+g]=b[S];return}for(var R=this.minGallop;;){var I=0,w=0,T=!1;do if(_(k[L],b[S])<0){if(k[E++]=k[L++],w++,I=0,--g===0){T=!0;break}}else if(k[E++]=b[S++],I++,w=0,--v===1){T=!0;break}while((I|w)<R);if(T)break;do{if(I=m(k[L],b,S,v,0,_),I!==0){for(M=0;M<I;M++)k[E+M]=b[S+M];if(E+=I,S+=I,v-=I,v<=1){T=!0;break}}if(k[E++]=k[L++],--g===0){T=!0;break}if(w=d(b[S],k,L,g,0,_),w!==0){for(M=0;M<w;M++)k[E+M]=k[L+M];if(E+=w,L+=w,g-=w,g===0){T=!0;break}}if(k[E++]=b[S++],--v===1){T=!0;break}R--}while(I>=i||w>=i);if(T)break;R<0&&(R=0),R+=2}if(this.minGallop=R,R<1&&(this.minGallop=1),v===1){for(M=0;M<g;M++)k[E+M]=k[L+M];k[E+g]=b[S]}else{if(v===0)throw new Error("mergeLow preconditions were not respected");for(M=0;M<v;M++)k[E+M]=b[S+M]}},h.prototype.mergeHigh=function(f,v,x,g){var _=this.compare,k=this.array,b=this.tmp,M=0;for(M=0;M<g;M++)b[M]=k[x+M];var S=f+v-1,L=g-1,E=x+g-1,R=0,I=0;if(k[E--]=k[S--],--v===0){for(R=E-(g-1),M=0;M<g;M++)k[R+M]=b[M];return}if(g===1){for(E-=v,S-=v,I=E+1,R=S+1,M=v-1;M>=0;M--)k[I+M]=k[R+M];k[E]=b[L];return}for(var w=this.minGallop;;){var T=0,A=0,$=!1;do if(_(b[L],k[S])<0){if(k[E--]=k[S--],T++,A=0,--v===0){$=!0;break}}else if(k[E--]=b[L--],A++,T=0,--g===1){$=!0;break}while((T|A)<w);if($)break;do{if(T=v-m(b[L],k,f,v,v-1,_),T!==0){for(E-=T,S-=T,v-=T,I=E+1,R=S+1,M=T-1;M>=0;M--)k[I+M]=k[R+M];if(v===0){$=!0;break}}if(k[E--]=b[L--],--g===1){$=!0;break}if(A=g-d(k[S],b,0,g,g-1,_),A!==0){for(E-=A,L-=A,g-=A,I=E+1,R=L+1,M=0;M<A;M++)k[I+M]=b[R+M];if(g<=1){$=!0;break}}if(k[E--]=k[S--],--v===0){$=!0;break}w--}while(T>=i||A>=i);if($)break;w<0&&(w=0),w+=2}if(this.minGallop=w,w<1&&(this.minGallop=1),g===1){for(E-=v,S-=v,I=E+1,R=S+1,M=v-1;M>=0;M--)k[I+M]=k[R+M];k[E]=b[L]}else{if(g===0)throw new Error("mergeHigh preconditions were not respected");for(R=E-(g-1),M=0;M<g;M++)k[R+M]=b[M]}},h})();function N(h,y,f,v){if(!Array.isArray(h))throw new TypeError("Can only sort arrays");y?typeof y!="function"&&(v=f,f=y,y=a):y=a,f||(f=0),v||(v=h.length);var x=v-f;if(!(x<2)){var g=0;if(x<r){g=c(h,f,v,y),l(h,f,v,f+g,y);return}var _=new p(h,y),k=s(x);do{if(g=c(h,f,v,y),g<k){var b=x;b>k&&(b=k),l(h,f,f+b,f+g,y),g=b}_.pushRun(f,g),_.mergeRuns(),x-=g,f+=g}while(x!==0);_.forceMergeRuns()}}})})(Xt)),Xt}var ye,bn;function zu(){return bn||(bn=1,ye=Cu()),ye}var kn;function br(){if(kn)return ct;kn=1,Object.defineProperty(ct,"__esModule",{value:!0}),ct.allocateSquareMatrix=r,ct.arrayCopy=i,ct.sumRows=o,ct.sortWithIndices=a;var t=zu(),e=n(t);function n(s){if(s&&s.__esModule)return s;var c={};if(s!=null)for(var u in s)Object.prototype.hasOwnProperty.call(s,u)&&(c[u]=s[u]);return c.default=s,c}function r(s){for(var c=arguments.length<=1||arguments[1]===void 0?null:arguments[1],u=new Array(s),l=0;l<s;l++)u[l]=new Array(s),c!==null&&u[l].fill(c);return u}function i(s){for(var c=new Array(s.length),u=s.length;u--;)c[u]=s[u];return c}function o(s){for(var c=void 0,u=s.length,l=new Array(u),d=0;d<u;d++){c=0;for(var m=0;m<u;m++)s[d][m]!==void 0&&(c+=s[d][m]);l[d]=c}return l}function a(s){for(var c=arguments.length<=1||arguments[1]===void 0?-1:arguments[1],u=arguments.length<=2||arguments[2]===void 0?!1:arguments[2],l=s.length,d=new Array(l),m=new Array(l),p=0,N=0;N<l;N++)s[N]===-1||N===c||(d[p]=N,m[p++]=s[N]);d.length=p,m.length=p,u?e.sort(d,function(y,f){return s[y]-s[f]}):d.sort(function(y,f){return s[y]-s[f]}),e.sort(d,function(y,f){return s[y]-s[f]}),m.sortIndices=d;for(var h=0;h<p;h++)m[h]=s[d[h]];return m}return ct}var Nn;function Ru(){if(Nn)return Nt;Nn=1,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.RapidNeighborJoining=void 0;var t=(function(){function i(o,a){for(var s=0;s<a.length;s++){var c=a[s];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(o,c.key,c)}}return function(o,a,s){return a&&i(o.prototype,a),s&&i(o,s),o}})(),e=br();function n(i,o){if(!(i instanceof o))throw new TypeError("Cannot call a class as a function")}Nt.RapidNeighborJoining=(function(){function i(o,a){var s=arguments.length<=2||arguments[2]===void 0?!1:arguments[2],c=arguments.length<=3||arguments[3]===void 0?function(m){return m.name}:arguments[3];if(n(this,i),a.length!=o.length){console.error("Row/column size of the distance matrix does not agree with the size of taxa matrix");return}var u=this.N=a.length;if(this.cN=this.N,s){this.D=new Array(u);for(var l=0;l<u;l++)this.D[l]=(0,e.arrayCopy)(o[l])}else this.D=o;this.taxa=a,this.labelToTaxon={},this.currIndexToLabel=new Array(u),this.rowChange=new Array(u),this.newRow=new Array(u),this.labelToNode=new Array(2*u),this.nextIndex=u,this.initializeSI(),this.removedIndices=new Set,this.indicesLeft=new Set;for(var d=0;d<u;d++)this.currIndexToLabel[d]=d,this.indicesLeft.add(d);return this.rowSumMax=0,this.PNewick="",this.taxonIdAccessor=c,this}return t(i,[{key:"initializeSI",value:function(){var a=this.N;this.I=new Array(a),this.S=new Array(a);for(var s=0;s<a;s++){var c=(0,e.sortWithIndices)(this.D[s],s,!0);this.S[s]=c,this.I[s]=c.sortIndices}}},{key:"search",value:function(){for(var a=1/0,s=this.D,c=this.cN,u=c-2,l=this.S,d=this.I,m=this.rowSums,p=this.removedIndices,N=this.rowSumMax,h=void 0,y=-1,f=-1,v=void 0,x=0;x<this.N;x++)p.has(x)||(v=d[x][0],!p.has(v)&&(h=s[x][v]*u-m[x]-m[v],h<a&&(a=h,y=x,f=v)));for(var g=0;g<this.N;g++)if(!p.has(g)){for(var _=0;_<l[g].length;_++)if(v=d[g][_],!p.has(v)){if(l[g][_]*u-m[g]-N>a)break;h=s[g][v]*u-m[g]-m[v],h<a&&(a=h,y=g,f=v)}}return{minI:y,minJ:f}}},{key:"run",value:function(){var a=void 0,s=void 0,c=void 0,u=void 0,l=void 0,d=void 0,m=void 0,p=void 0,N=void 0,h=this;function y(_,k){var b=void 0;return _<h.N?(b=new r(h.taxa[_],k),h.labelToNode[_]=b):(b=h.labelToNode[_],b.setLength(k)),b}this.rowSums=(0,e.sumRows)(this.D);for(var f=0;f<this.cN;f++)this.rowSums[f]>this.rowSumMax&&(this.rowSumMax=this.rowSums[f]);for(;this.cN>2;){var v=this.search();a=v.minI,s=v.minJ,c=.5*this.D[a][s]+(this.rowSums[a]-this.rowSums[s])/(2*this.cN-4),u=this.D[a][s]-c,l=this.currIndexToLabel[a],d=this.currIndexToLabel[s],m=y(l,c),p=y(d,u),N=new r(null,null,m,p),this.recalculateDistanceMatrix(a,s);var x=(0,e.sortWithIndices)(this.D[s],s,!0);this.S[s]=x,this.I[s]=x.sortIndices,this.S[a]=this.I[a]=[],this.cN--,this.labelToNode[this.nextIndex]=N,this.currIndexToLabel[a]=-1,this.currIndexToLabel[s]=this.nextIndex++}var g=this.indicesLeft.values();a=g.next().value,s=g.next().value,l=this.currIndexToLabel[a],d=this.currIndexToLabel[s],c=u=this.D[a][s]/2,m=y(l,c),p=y(d,u),this.P=new r(null,null,m,p)}},{key:"recalculateDistanceMatrix",value:function(a,s){var c=this.D,u=c.length,l=0,d=void 0,m=void 0,p=this.removedIndices,N=this.rowSums,h=this.newRow,y=this.rowChange,f=0;p.add(a);for(var v=0;v<u;v++)p.has(v)||(d=c[a][v]+c[s][v],m=c[a][s],h[v]=.5*(d-m),l+=h[v],y[v]=-.5*(d+m));for(var x=0;x<u;x++)c[a][x]=-1,c[x][a]=-1,!p.has(x)&&(c[s][x]=h[x],c[x][s]=h[x],N[x]+=y[x],N[x]>f&&(f=N[x]));N[a]=0,N[s]=l,l>f&&(f=l),this.rowSumMax=f,this.indicesLeft.delete(a)}},{key:"createNewickTree",value:function(a){if(a.taxon)this.PNewick+=this.taxonIdAccessor(a.taxon);else{this.PNewick+="(";for(var s=0;s<a.children.length;s++)this.createNewickTree(a.children[s]),s<a.children.length-1&&(this.PNewick+=",");this.PNewick+=")"}a.length&&(this.PNewick+=":"+a.length)}},{key:"getAsObject",value:function(){return this.P}},{key:"getAsNewick",value:function(){return this.PNewick="",this.createNewickTree(this.P),this.PNewick+=";",this.PNewick}}]),i})();var r=(function(){function i(){var o=arguments.length<=0||arguments[0]===void 0?null:arguments[0],a=arguments.length<=1||arguments[1]===void 0?null:arguments[1],s=arguments.length<=2||arguments[2]===void 0?null:arguments[2],c=arguments.length<=3||arguments[3]===void 0?null:arguments[3];n(this,i),this.taxon=o,this.length=a,this.children=[],s!==null&&this.children.push(s),c!==null&&this.children.push(c)}return t(i,[{key:"setLength",value:function(a){this.length=a}}]),i})();return Nt}var ve,Mn;function Du(){return Mn||(Mn=1,ve={RapidNeighborJoining:Ru().RapidNeighborJoining,allocateSquareMatrix:br().allocateSquareMatrix}),ve}var Ou=Du();const Bu=Iu(Ou);let tt,U,kr;function Pu(t,e,n){U=e,kr=n,t.selectAll("*").remove(),tt=t.append("g");const r=u=>{tt.attr("transform",u.transform)},i=pr().scaleExtent([.1,4]).on("zoom",r),{width:o,height:a}=t.node().getBoundingClientRect(),s=.5,c=Ve.translate(o*(1-s)+20,a*(1-s)+60).scale(s);t.call(i).call(i.transform,c),tt.attr("transform",c)}function Nr(t){if(!t)return null;const e=new Bu.RapidNeighborJoining(t,U,!1,n=>n.name);return e.run(),e.getAsObject()}function Fu(t){const e=[],n=[];let r=0;function i(o,a){const s=r++;e.push({id:s,data:o}),a!==null&&n.push({source:a,target:s,length:o.branch_length||1}),o.children&&o.children.forEach(c=>i(c,s))}return i(t,null),{nodes:e,links:n}}function Mr(t){if(!tt||!t){tt&&tt.selectAll("*").remove();return}tt.selectAll("*").remove();const{width:e,height:n}=tt.node().parentElement.getBoundingClientRect(),{nodes:r,links:i}=Fu(t),o=Zt(i,l=>l.length),a=He().domain([0,o]).range([5,40]),s=ar(r).force("link",or(i).id(l=>l.id).distance(l=>a(l.length))).force("charge",sr().strength(-300)).force("center",nr(e/2,n/2)).stop();s.tick(300),tt.append("g").attr("stroke","#555").attr("stroke-width",1.5).selectAll("line").data(i).enter().append("line").attr("x1",l=>l.source.x).attr("y1",l=>l.source.y).attr("x2",l=>l.target.x).attr("y2",l=>l.target.y);const c=tt.append("g").selectAll("g").data(r).enter().append("g").attr("transform",l=>`translate(${l.x},${l.y})`);c.append("circle").attr("r",14).attr("fill",l=>l.data.children&&l.data.children.length>0?"#555":kr(l.data.taxon.name)),c.append("text").attr("dy","0.31em").attr("x",18).style("font-size","2em").style("text-anchor","start").text(l=>l.data.taxon?.name||"").attr("class","node-label");function u(l){function d(N,h){N.active||l.alphaTarget(.3).restart(),h.fx=h.x,h.fy=h.y}function m(N,h){h.fx=N.x,h.fy=N.y}function p(N,h){N.active||l.alphaTarget(0),h.fx=null,h.fy=null}return Hn().on("start",d).on("drag",m).on("end",p)}c.call(u(s))}function qu(t,e){const n=()=>U?U.length:0,r=Array.from({length:n()},()=>Array(n()).fill(0));for(let i=0;i<n();i++)for(let o=i+1;o<n();o++){const a=U[i].name,s=U[o].name,c=e.find(l=>{const d=typeof l.source=="object"?l.source.id:l.source,m=typeof l.target=="object"?l.target.id:l.target;return d===a&&m===s||m===a&&d===s}),u=c&&c.beatCounts[t]||0;r[i][o]=r[o][i]=u}return r}function Hu(t,e,n){U=n;const r=qu(t,e),i=Nr(r);Mr(i)}function Vu(t,e){U=e;const n=()=>U?U.length:0,r=t.map(a=>({...a,totalDiffs:Sn(Object.values(a.beatCounts))})),i=Array.from({length:n()},()=>Array(n()).fill(0));for(let a=0;a<n();a++)for(let s=a+1;s<n();s++){const c=U[a].name,u=U[s].name,l=r.find(d=>{const m=typeof d.source=="object"?d.source.id:d.source,p=typeof d.target=="object"?d.target.id:d.target;return m===c&&p===u||p===c&&m===u});i[a][s]=i[s][a]=l?l.totalDiffs:0}const o=Nr(i);Mr(o)}function Xu(){let t="";for(const e of document.styleSheets)try{for(const n of e.cssRules)n.cssText&&(t+=n.cssText)}catch(n){console.warn("Cannot read cross-origin stylesheet",n)}return t}function Ar(t,e,n){const r=new Blob([e],{type:n}),i=URL.createObjectURL(r),o=document.createElement("a");o.href=i,o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)}function Sr(t){const e=t.cloneNode(!0),n=Xu(),r=document.createElement("style");return r.textContent=n,e.insertBefore(r,e.firstChild),new XMLSerializer().serializeToString(e)}function An(t,e){if(!t)return;const n=Sr(t);Ar(e,n,"image/svg+xml")}function Gu(t,e){if(!t)return;const n=Sr(t),r=new Blob([n],{type:"image/svg+xml;charset=utf-8"}),i=URL.createObjectURL(r),o=new Image;o.onload=()=>{const a=document.createElement("canvas"),s=2;a.width=t.getBoundingClientRect().width*s,a.height=t.getBoundingClientRect().height*s;const c=a.getContext("2d");c.scale(s,s),c.drawImage(o,0,0);const u=a.toDataURL("image/png");Ar(e,u,"image/png"),URL.revokeObjectURL(i)},o.onerror=a=>{console.error("Could not load SVG into image",a),URL.revokeObjectURL(i),alert("Sorry, the image could not be exported.")},o.src=i}const O={state:{},elements:{}};window.addEventListener("DOMContentLoaded",Uu);function Uu(){O.elements={netSvg:q("#network"),treeSvg:q("#tree"),axSvg:q("#axis"),axisLabelContainer:q("#axis-labels"),beatSlider:document.getElementById("beatSlider"),beatLabel:document.getElementById("beatLabel"),tooltip:q("#tooltip"),fileInput:document.getElementById("diffFiles")},Mu({loadBtn:document.getElementById("loadBtn"),exampleBtn:document.getElementById("exampleBtn"),totalTreeBtn:document.getElementById("totalTreeBtn"),totalNetworkBtn:document.getElementById("totalNetworkBtn"),resetViewBtn:document.getElementById("resetViewBtn")},()=>Yu(O.elements.fileInput.files),Ju,Wu,Ku),O.elements.beatSlider.oninput=()=>{O.state.isLiveView&&zt(O.elements.beatSlider.value)},Mo('input[name="visType"]').on("change",()=>{O.state.isLiveView&&zt(O.elements.beatSlider.value)})}async function Yu(t){if(!(!t||t.length===0)){yr();try{O.state=await wr({files:t}),Er()}catch(e){console.error("Fehler beim Verarbeiten der Dateien:",e)}finally{vr()}}}async function Ju(){yr();try{O.state=await wr({useExample:!0}),Er()}catch(t){console.error("Fehler beim Laden der Beispieldaten:",t)}finally{vr()}}function Er(){const{nodes:t,linkData:e,beatInfo:n,allBeatKeys:r,globalMax:i,nodeColor:o,axisColor:a,taxa:s}=O.state,{netSvg:c,treeSvg:u,axSvg:l,axisLabelContainer:d,beatSlider:m,tooltip:p}=O.elements;Au(a);const N=$u(l,d,p,e,r,n,i,a,o,zt);O.state.beatX=N,Lu(c,t,e,o),Pu(u,s,o),O.state.taxa=s,O.state.isLiveView=!0,m.min=0,m.max=r.length>0?r.length-1:0,m.disabled=!1,zt(0)}function zt(t){if(!O.state.allBeatKeys||O.state.allBeatKeys.length===0)return;const{allBeatKeys:e,beatInfo:n,beatX:r,linkData:i,globalMax:o,taxa:a}=O.state,{netSvg:s,treeSvg:c,beatSlider:u}=O.elements;t=Math.max(0,Math.min(e.length-1,+t)),Te(`Live-View | Measure: ${n[e[t]].measure}, Beat: ${n[e[t]].beat.toFixed(2)}`),xr(t,r),u.value=t,document.querySelector('input[name="visType"]:checked').value==="network"?(s.style("display","block"),c.style("display","none"),_r(t,i,o)):(s.style("display","none"),c.style("display","block"),Hu(t,i,a))}function Wu(t){const{netSvg:e,treeSvg:n,beatSlider:r}=O.elements;O.state.isLiveView=!1,r.disabled=!0,xr(null,null),t==="total-network"?(Te("Total View (Network)"),e.style("display","block"),n.style("display","none"),_r(null,O.state.linkData,O.state.globalMax,!0)):t==="total-tree"?(Te("Total View (Tree)"),e.style("display","none"),n.style("display","block"),Vu(O.state.linkData,O.state.taxa)):t==="reset"&&(O.state.isLiveView=!0,r.disabled=!1,zt(r.value))}function Ku(t){const e=new Date,n=`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`;t==="network"?An(O.elements.netSvg.node(),`network-${n}.svg`):t==="tree"?An(O.elements.treeSvg.node(),`tree-${n}.svg`):t==="axis"&&Gu(O.elements.axSvg.node(),`axis-${n}.png`)}
